define("modules/clean/react/path_filter_button",["require","exports","tslib","react","spectrum/dropdown_button","modules/clean/react/title_bubble","modules/clean/em_string","modules/clean/filepath","dig-components/buttons","dig-components/tooltips","modules/clean/react/sticky_position"],(function(e,t,i,n,o,r,l,a,s,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathFilterButton=void 0,n=i.__importDefault(n),a=i.__importStar(a),t.PathFilterButton=function(e){var t=e.path,i=e.defaultText,u=e.dropdownClasses,p=e.disabled,f=e.onClick,m=e.useDigComponents,h=t&&!a.paths_are_equal(t,"/")?l.Emstring.em_snippet(a.filename(t),10,.6):null;if(m){var g=n.default.createElement(s.Button,{className:u,disabled:p,onClick:f,variant:"opacity",withDropdownIcon:!0},h||i);return t&&h?n.default.createElement(d.Tooltip,{title:t,placement:"bottom"},g):g}var _=n.default.createElement(o.DropdownButton,{className:u,disabled:p,onClick:f},h||i);return h?n.default.createElement(r.TitleBubble,{content:t,position:c.StickyPosition.BOTTOM},_):_}})),define("modules/clean/react/selectable_list",["require","exports","tslib","immutable","keymaster","react","external/lodash","react-dom","modules/core/browser_detection"],(function(e,t,i,n,o,r,l,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectableList=t.findSelectionRange=t.findNeighboringItem=t.SelectOptions=t.SelectDirection=t.SelectableListActionSource=t.SELECTABLE_TILE_GRID_KEY_SCOPE=t.SELECTABLE_LIST_KEY_SCOPE=void 0,n=i.__importStar(n),o=i.__importDefault(o),r=i.__importDefault(r),l=i.__importStar(l),a=i.__importStar(a),s=i.__importStar(s),t.SELECTABLE_LIST_KEY_SCOPE="SelectableList",t.SELECTABLE_TILE_GRID_KEY_SCOPE="SelectableTileGrid";var d,c,u,p="";function f(e,t,i,n,o,r){switch(e){case c.PREV:return Math.max(0,t-1);case c.NEXT:return Math.min(i-1,t+1);case c.PREV_ROW:case c.NEXT_ROW:return(function(e,t,i,n,o,r){if(void 0===r&&(r=!1),t<0||t>=i)return 0;o&&0!==o.length||(o=[0]);var a=l.sortedIndex(o,t),s=o[a]===t?a:a-1,d=o[s],u=(t-d)%n;switch(e){case c.NEXT_ROW:var p=o.length;if(s===p-1&&t+n>=i){var f=(i-d)%n;if((t-d)%n<f||0===f)return r?i-1:t}var m=s+1,h=m<o.length?o[m]:i;if(t+n-(n-((h-d)%n||n))<h){var g=h-1;return Math.min(t+n,g)}var _=m+1<p?o[m+1]-1:i-1;return Math.min(h+u,_);case c.PREV_ROW:if(0===s&&t-n<0)return r?0:t;if(t-n>=d)return t-n;var E=o[s-1],T=d-1,S=d-E,v=E+S-(S%n||n);return Math.min(v+u,T)}})(e,t,i,n,o,r)}}function m(e,t,i,n,o,r,l,a,s){switch(e){case c.PREV:case c.PREV_ROW:if(0===t)return l;for(var d=f(e,t,a.length,i,s,!0),u=Math.min(t,n)-d,p=t-Math.max(d,n),m=r;m>r-p;m--){var h=l.indexOf(a[m]);l.splice(h,1)}for(m=o-1;m>=o-u;m--)l.push(a[m]);break;case c.NEXT:case c.NEXT_ROW:if(t===a.length)return l;var g=f(e,t,a.length,i,s,!0);for(p=Math.min(g,n)-o,u=g-Math.max(t,n),m=o;m<o+p;m++){h=l.indexOf(a[m]);l.splice(h,1)}for(m=r+1;m<=r+u;m++)l.push(a[m])}return l}(function(e){e.KEYBOARD="keyboard",e.DRAG_TO_SELECT="drag_to_select"})(d=t.SelectableListActionSource||(t.SelectableListActionSource={})),(function(e){e[e.PREV=0]="PREV",e[e.NEXT=1]="NEXT",e[e.PREV_ROW=2]="PREV_ROW",e[e.NEXT_ROW=3]="NEXT_ROW"})(c=t.SelectDirection||(t.SelectDirection={})),(function(e){e.DEFAULT="DEFAULT",e.EXTEND="EXTEND",e.ONLY="ONLY"})(u=t.SelectOptions||(t.SelectOptions={})),t.findNeighboringItem=f,t.findSelectionRange=m;var h=(function(e){function l(t){var i=e.call(this,t)||this;return i.isFocused=!1,i.updateSelection=function(e,t,o){void 0===o&&(o=!1);var r=i.props.selection,l=o?e.length?e[0]:i.props.itemIds[0]:r.anchor,a=r.merge({selected:n.OrderedSet(e),anchor:l});i.props.onSelectionChange(a,t)},i.handleSelectPrevious=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.selectNeighboringItem(c.PREV,d.KEYBOARD))},i.handleSelectPreviousRow=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.selectNeighboringItem(c.PREV_ROW,d.KEYBOARD))},i.handleExtendSelectionToPrevious=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.extendSelectionRange(c.PREV,d.KEYBOARD))},i.handleExtendSelectionToPreviousRow=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.extendSelectionRange(c.PREV_ROW,d.KEYBOARD))},i.handleSelectNext=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.selectNeighboringItem(c.NEXT,d.KEYBOARD))},i.handleSelectNextRow=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.selectNeighboringItem(c.NEXT_ROW,d.KEYBOARD))},i.handleExtendSelectionToNext=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.extendSelectionRange(c.NEXT,d.KEYBOARD))},i.handleExtendSelectionToNextRow=function(e){i.isGlobalEvent(e)&&(e.preventDefault(),i.extendSelectionRange(c.NEXT_ROW,d.KEYBOARD))},i.handleKeyboardDeselectAll=function(e){var t=i.props.selection;e&&!i.isGlobalEvent(e)||!t.selected.size||i.handleDeselectAll(d.KEYBOARD)},i.handleDeselectAll=function(e){if(i.updateSelection([],e,!0),a.findDOMNode(i).contains(document.activeElement)){var t=document.activeElement;t.blur&&t.blur()}i.props.onDeselectAll&&i.props.onDeselectAll()},i.handleKeyboardSelectAll=function(e){var t=i.props,n=t.itemIds,o=t.selection;e&&!i.isGlobalEvent(e)||o.selected.size===n.length||i.handleSelectAll(d.KEYBOARD)},i.handleSelectAll=function(e){i.updateSelection(i.props.itemIds,e,!0)},i.handleDeselect=function(e,t,n){if(t)return i.extendOrShrinkSelectionByFile(e,n);i.updateSelectionById(e,"delete",n)},i.handleSelect=function(e,t,n){if(void 0===t&&(t=u.DEFAULT),t===u.EXTEND)return i.extendOrShrinkSelectionByFile(e);t===u.ONLY?i.updateSelection([e],n,!0):i.updateSelectionById(e,"add",n)},i.handleFocusFile=function(e){i.setState({focusedFileId:e})},i.isSelectableListEvent=function(){return i.isFocused},i.handleFocus=function(){i.isFocused=!0},i.handleBlur=function(){i.isFocused=!1},i.state={selection:t.selection,keyScope:t.keyScope},i}return i.__extends(l,e),l.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.keyScope!==e.keyScope&&(this.setState({keyScope:e.keyScope}),this.isFocused=!1)},l.prototype.componentDidMount=function(){this.setupKeyboardShortcuts(),this.setFocusedIdFromSelection(this.props.selection)},l.prototype.componentDidUpdate=function(e,t){e.selection&&this.props.selection&&e.selection.anchor!==this.props.selection.anchor&&this.setFocusedIdFromSelection(this.props.selection),this.state.keyScope!==t.keyScope&&this.setupKeyboardShortcuts(),e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():this.cleanupKeyboardShortcuts())},l.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts()},l.prototype.setupKeyboardShortcuts=function(){var e=this,i=this.state.keyScope;(p=o.default.getScope())!==i&&o.default.setScope(i);var n=o.default.filter||function(e){var t=e.target||e.srcElement;if(!(t instanceof Element))return!0;var i=t.tagName;return!("INPUT"===i||"SELECT"===i||"TEXTAREA"===i)};o.default.filter=function(t){var i=t.target||t.srcElement,o=i.tagName;return(!e.isSelectableListEvent()||"BUTTON"!==o)&&(i instanceof HTMLInputElement&&"checkbox"===i.type||n.call(e,t))},i===t.SELECTABLE_LIST_KEY_SCOPE?(o.default("up",i,this.handleSelectPrevious),o.default("shift+up",i,this.handleExtendSelectionToPrevious),o.default("down",i,this.handleSelectNext),o.default("shift+down",i,this.handleExtendSelectionToNext)):i===t.SELECTABLE_TILE_GRID_KEY_SCOPE&&(o.default("left",i,this.handleSelectPrevious),o.default("shift+left",i,this.handleExtendSelectionToPrevious),o.default("right",i,this.handleSelectNext),o.default("shift+right",i,this.handleExtendSelectionToNext),o.default("up",i,this.handleSelectPreviousRow),o.default("shift+up",i,this.handleExtendSelectionToPreviousRow),o.default("down",i,this.handleSelectNextRow),o.default("shift+down",i,this.handleExtendSelectionToNextRow)),o.default("escape",i,this.handleKeyboardDeselectAll),s.mac?o.default("command+a",i,this.handleKeyboardSelectAll):o.default("ctrl+a",i,this.handleKeyboardSelectAll)},l.prototype.cleanupKeyboardShortcuts=function(){o.default.clearScope(this.state.keyScope),p&&o.default.setScope(p),o.default.resetFilter()},l.prototype.setFocusedIdFromSelection=function(e){e.anchor&&0!==e.selected.size&&this.setState({focusedFileId:e.anchor})},l.prototype.selectNeighboringItem=function(e,t){var i=this.props,n=i.itemIds,o=i.selection,r=i.tilesPerRow,l=i.sectionStartIndices,a=n.indexOf(o.selected.last()),s=n[f(e,a,n.length,r,l)];this.setState({focusedFileId:s}),this.updateSelection([s],t,!0)},l.prototype.extendSelectionRange=function(e,t){var i=this.props,n=i.itemIds,o=i.selection,r=i.tilesPerRow,l=i.sectionStartIndices,a=o.anchor||n[0];if(a){var s=n.indexOf(o.selected.last()),d=o.selected.toArray(),c=n.indexOf(a),u=this.getRangeOfSelectedBlock(a);d=m(e,s,r,c,u.startIndex,u.endIndex,d,n,l),this.setState({focusedFileId:d[d.length-1]}),this.updateSelection(d,t)}},l.prototype.getRangeOfSelectedBlock=function(e){for(var t=this.props,i=t.itemIds,n=t.selection,o=i.indexOf(e),r=0,l=0;r=o,!(--o<0)&&n.selected.has(i[o]););for(o=r;;){var a=i[o];if(!a||!n.selected.has(a))break;l=o,o++}return{startIndex:r,endIndex:l}},l.prototype.extendOrShrinkSelectionByFile=function(e,t){var i=this.props,n=i.itemIds,o=i.selection,r=o.anchor||n[0];if(r){var l=n.indexOf(r),a=n.indexOf(e),s=this.getRangeOfSelectedBlock(r),d=s.startIndex,c=s.endIndex,u=[],p=[];n.forEach((function(e,t){d<=t&&t<=c&&u.push(e),(a<=t&&t<=l||l<=t&&t<=a)&&p.push(e)})),a<l&&p.reverse();var f=o.update("selected",(function(e){return e.subtract(u).union(p)}));this.setState({focusedFileId:e}),this.props.onSelectionChange(f,t)}},l.prototype.updateSelectionById=function(e,t,i){var n=this.props.selection,o="add"===t?e:n.anchor,r=n.selected[t](e),l=n.merge({selected:r,anchor:o||null});this.props.onSelectionChange(l,i)},l.prototype.isGlobalEvent=function(e){var t=e.target instanceof HTMLInputElement,i=e.target instanceof HTMLElement,n=t&&"checkbox"===e.target.type,o=i&&(e.target.classList.contains("mc-popover-selectable-item")||e.target.classList.contains("mc-popover-content-item")||e.target.classList.contains("mc-popover-trigger"));return!document.activeElement||document.activeElement===document.body||e.target instanceof Element&&(a.findDOMNode(this).contains(e.target)&&(!t||n)&&!o)},l.prototype.render=function(){var e=this.props.children,t=this.state.focusedFileId;if(!e)return null;var i=e;return"function"==typeof e&&(i=e({focusedFileId:t,updateSelection:this.updateSelection,handleDeselect:this.handleDeselect,handleDeselectAll:this.handleDeselectAll,handleFocusFile:this.handleFocusFile,handleSelect:this.handleSelect,handleSelectAll:this.handleSelectAll,isSelectableListEvent:this.isSelectableListEvent})),r.default.createElement("div",{className:"selectable-list",onBlur:this.handleBlur,onFocus:this.handleFocus},i)},l.defaultProps={isActive:!0},l})(r.default.PureComponent);t.SelectableList=h})),define("modules/clean/react/tree_view",["require","exports","tslib","classnames","immutable","react","react-dom","external/lodash","modules/clean/react/icon/folder_icon","spectrum/icon_content","jquery","modules/clean/ajax","modules/clean/em_string","modules/clean/filepath","modules/clean/keycode","modules/clean/react/css","modules/clean/react/sprite","modules/core/i18n","modules/core/notify"],(function(e,t,i,n,o,r,l,a,s,d,c,u,p,f,m,h,g,_,E){"use strict";var T;Object.defineProperty(t,"__esModule",{value:!0}),t.UserFolderTreeView=t.AdminFolderTreeView=t.PinnedFolderTreeView=t.FolderTreeView=t.FolderTreeItem=t.RootIcon=t.TreeView=t.TreeItemView=t.Tree=t.TreeItem=t.RootStyle=t.INDENT_SIZE_PX=t.MAX_LABEL_LENGTH=void 0,n=i.__importDefault(n),o=i.__importStar(o),r=i.__importDefault(r),l=i.__importStar(l),a=i.__importStar(a),c=i.__importDefault(c),u=i.__importStar(u),t.MAX_LABEL_LENGTH=20,t.INDENT_SIZE_PX=15,(function(e){e[e.None=0]="None",e[e.TreeItem=1]="TreeItem",e[e.HeaderItem=2]="HeaderItem",e[e.StaticHeader=3]="StaticHeader"})(T=t.RootStyle||(t.RootStyle={}));var S=function(e){this.key=e.key,this.label=e.label?e.label:"",this.icon=e.icon?e.icon:"",this.disabled=!!e.disabled,this.canExpand=!!e.canExpand,this.forceExpanded=!!e.forceExpanded,this.readOnly=!!e.readOnly};t.TreeItem=S;var v=(function(){function e(e){var t=o.Map();this.rootItem=e.rootItem,this.items=e.items,this.childItemsByParentKey=e.childItemsByParentKey||t,this.parentItemByChildKey=e.parentItemByChildKey||o.Map()}return e.createWithRootItem=function(t){return new e({rootItem:t,items:o.Map([[t.key,t]])})},e.prototype.getParentItem=function(e){if(e){var t=this.parentItemByChildKey.get(e.key);return t?this.items.get(t):null}},e.prototype.getChildItems=function(e){return this.childItemsByParentKey.get(e.key)||null},e.prototype.isParent=function(e){return this.childItemsByParentKey.has(e.key)},e.prototype.getClosestExistingChildFromKey=function(e){for(var t,i=e.split("/"),n=this.rootItem,o=function(e){var o=i.slice(0,e).join("/"),l=null===(t=r.getChildItems(n))||void 0===t?void 0:t.find((function(e){return e.key===o}));if(void 0===l)return{value:n};n=l},r=this,l=2;l<i.length+1;l++){var a=o(l);if("object"==typeof a)return a.value}return n},e.prototype.setChildItems=function(t,i){i=o.List(i);var n=o.Map(i.map((function(e){return[e.key,e]}))),r=o.Map(this.items).merge(n),l=o.Map(this.childItemsByParentKey).set(t.key,i),a=o.Map(this.parentItemByChildKey);return i.forEach((function(e){return a=a.set(e.key,t.key)})),new e({rootItem:this.rootItem,items:r,childItemsByParentKey:l,parentItemByChildKey:a})},e})();t.Tree=v;var b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){return r.default.createElement("ul",{className:"tree-view__group",role:"group"},this.props.children)},t})(r.default.Component),I=(function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){if(e.preventDefault(),e.stopPropagation(),!t.props.item.disabled){var i=l.findDOMNode(t.refs.expandButton);i&&i.contains(e.target)||t.props.onClick&&t.props.onClick(t.props.item)}},t.handleExpandClick=function(e){e.preventDefault(),t.props.onExpandButtonClick&&t.props.onExpandButtonClick(t.props.item,!t.props.isExpanded)},t}return i.__extends(o,e),o.prototype.renderExpandButton=function(){return r.default.createElement("div",{className:"tree-view__expand-button",onClick:this.handleExpandClick,ref:"expandButton",role:"button"},r.default.createElement(g.Sprite,{group:"web",name:this.props.isExpanded?"bullet_minus":"bullet_plus",alt:this.props.isExpanded?_.intl.formatMessage({id:"nPGI06",defaultMessage:"Collapse"}):_.intl.formatMessage({id:"mGnlBs",defaultMessage:"Expand"})}))},o.prototype.renderIcon=function(){var e=this.props.item,t=e.icon,i=e.disabled;return r.default.createElement("div",{className:"tree-view__icon-wrapper"},r.default.createElement(d.IconContent,{className:"tree-view__item-icon",name:s.convertLegacyFolderIconToSpectrum(t,"small"),disabled:i,height:19,width:19}))},o.prototype.render=function(){var e=!this.props.canExpand,i=n.default({"tree-view__item":!0,"tree-view__item--leaf":e}),o=this.props.canExpand&&!this.props.showAsHeader;return r.default.createElement("li",{key:this.props.item.key,id:this.props.id,className:i,onClick:this.handleClick,role:"treeitem","aria-disabled":this.props.item.disabled,"aria-label":this.props.item.label,"aria-level":this.props.level+1,"aria-selected":!!this.props.isSelected||void 0,"aria-expanded":o?this.props.isExpanded:void 0},r.default.createElement("span",{className:n.default({"tree-view__item-row":!0,"tree-view__item-row--disabled":this.props.item.disabled}),style:{paddingLeft:this.props.showAsHeader?0:this.props.level*t.INDENT_SIZE_PX}},this.props.showAsHeader||e?void 0:this.renderExpandButton(),this.props.item.icon?this.renderIcon():void 0,this.props.item.label?r.default.createElement("span",{className:"tree-view__item-label"},p.Emstring.em_snippet(this.props.item.label,t.MAX_LABEL_LENGTH)):void 0),this.props.children)},o.defaultProps={isSelected:!1,isExpanded:!1,canExpand:!1,level:0,onClick:a.noop,onExpandButtonClick:a.noop,showAsHeader:!1},o})(r.default.Component);t.TreeItemView=I;var w,y=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.renderIcon=function(){return this.props.item.icon?r.default.createElement(g.Sprite,{className:"tree-view__header-icon",group:"web",name:this.props.item.icon,alt:""}):null},t.prototype.render=function(){return r.default.createElement("div",{className:"tree-view__item-row"},this.renderIcon(),r.default.createElement("h3",{className:"tree-view__header",id:this.props.id},this.props.item.label))},t})(r.default.Component),L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedItemKey:null,expandedItemKeys:o.Set([t.props.tree.rootItem.key]),showFocused:!1},t.selectItem=function(e){t.setState({selectedItemKey:null!=e&&e.key?e.key:null}),t.props.onItemSelected(e)},t.handleExpandButtonClick=function(e,i){t.setState({expandedItemKeys:t.setItemExpanded(e.key,i)}),t.props.onItemExpanded(e,i)},t.handleKeyDown=function(e){switch(e.which){case m.KeyCode.UP:t.advanceSelection(!0)&&e.preventDefault();break;case m.KeyCode.DOWN:t.advanceSelection(!1)&&e.preventDefault();break;case m.KeyCode.RIGHT:if(null!=t.state.selectedItemKey){var i=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(i)&&(t.handleExpandButtonClick(i,!0),e.preventDefault())}break;case m.KeyCode.LEFT:if(t.state.selectedItemKey){i=t.props.tree.items.get(t.state.selectedItemKey);t.canItemExpand(i)&&(t.handleExpandButtonClick(i,!1),e.preventDefault())}}},t.handleOnFocus=function(){return t.setState({showFocused:!0})},t.handleOnBlur=function(){return t.setState({showFocused:!1})},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){c.default(l.findDOMNode(this)).on({keydown:this.handleKeyDown})},t.prototype.componentWillReceiveProps=function(e){e.resetSelectedItem&&e.resetSelectedItem!==this.props.resetSelectedItem&&this.setState({selectedItemKey:null})},t.prototype.componentWillUnmount=function(){c.default(l.findDOMNode(this)).off("keydown")},t.prototype.componentDidUpdate=function(e,t){if(this.state.selectedItemKey&&this.state.selectedItemKey!==t.selectedItemKey){var i=c.default(l.findDOMNode(this)),n=i.find('[aria-selected="true"]').eq(0);n.length&&this.scrollElementIntoViewIfNeeded(n,i)}},t.prototype.scrollElementIntoViewIfNeeded=function(e,t){var i=t.scrollTop(),n=i+e.position().top;if(n-i<0)t.scrollTop(n);else{var o=t.innerHeight(),r=i+o,l=e.innerHeight();n+l>r&&t.scrollTop(n-o+l)}},t.prototype.hasSelectableRootItem=function(){var e=this.props.rootStyle;return e===T.TreeItem||e===T.HeaderItem},t.prototype.getHTMLIdPrefix=function(){return this.HTMLIdPrefix||(this.HTMLIdPrefix="tree-view-"+Math.floor(16777215*Math.random()).toString(16))},t.prototype.getLastLeafOf=function(e){var t=this.props.tree.getChildItems(e);return this.state.expandedItemKeys.contains(e.key)&&null!=t&&t.size>0?this.getLastLeafOf(t.last()):e},t.prototype.getPrevItem=function(e){if(!e)return null;var t=this.props.tree.getParentItem(e);if(!t)return null;var i=this.props.tree.getChildItems(t),n=i.indexOf(e);return n>0?this.getLastLeafOf(i.get(n-1)):0===n?t===this.props.tree.rootItem&&!this.hasSelectableRootItem()?null:t:null},t.prototype.getNextItem=function(e,t){if(void 0===t&&(t=!0),!e)return null;var i=this.state.expandedItemKeys.contains(e.key)&&this.props.tree.isParent(e);if(t&&i)return this.props.tree.getChildItems(e).first();var n=this.props.tree.getParentItem(e);if(!n)return null;var o=this.props.tree.getChildItems(n),r=o.size-1,l=o.indexOf(e);return l===r?this.getNextItem(n,!1):0<=l&&l<r&&o.get(l+1)||null},t.prototype.advanceSelection=function(e){if(void 0===e&&(e=!1),!this.state.selectedItemKey){var t=void 0;if(this.hasSelectableRootItem())t=this.props.tree.rootItem;else{var i=this.props.tree.getChildItems(this.props.tree.rootItem);t=i?i.first():null}return this.selectItem(t),!0}var n=this.props.tree.items.get(this.state.selectedItemKey),o=e?this.getPrevItem(n):this.getNextItem(n);return!!o&&(this.selectItem(o),!0)},t.prototype.getValidHTMLIdForItem=function(e){return(""+this.getHTMLIdPrefix()+e.key).replace(/\s+/g,"_")},t.prototype.setItemExpanded=function(e,t){return t?this.state.expandedItemKeys.add(e):this.state.expandedItemKeys.delete(e)},t.prototype.canItemExpand=function(e){return e&&(e.canExpand||this.props.tree.isParent(e))},t.prototype.renderSingleItem=function(e,t,n,o){void 0===o&&(o={});var l=i.__assign({id:this.getValidHTMLIdForItem(e),key:e.key,item:e,isSelected:this.state.selectedItemKey===e.key,isExpanded:this.state.expandedItemKeys.contains(e.key)||e.forceExpanded,canExpand:this.canItemExpand(e)&&!e.forceExpanded,level:t,onClick:this.selectItem,onExpandButtonClick:this.handleExpandButtonClick},o),a=this.props.treeItemView;return r.default.createElement(a,i.__assign({},l),n)},t.prototype.renderItemAndDescendants=function(e,t){var i,n=this.state.expandedItemKeys.contains(e.key)||e.forceExpanded;return this.props.tree.isParent(e)&&n&&(i=this.renderChildrenOfItemAsGroup(e,t+1)),this.renderSingleItem(e,t,i)},t.prototype.renderChildrenOfItemAsGroup=function(e,t){var i=this;if(!e||!this.props.tree.isParent(e))return null;var n=this.props.tree.getChildItems(e).map((function(e){return i.renderItemAndDescendants(e,t)}));return r.default.createElement(b,null,n.toJS())},t.prototype.render=function(){var e,t,i,o=this.props.tree.rootItem;if(this.props.rootStyle===T.TreeItem)t=r.default.createElement(b,null,this.renderItemAndDescendants(o,0));else if(this.props.rootStyle===T.HeaderItem)e=this.getValidHTMLIdForItem(o),t=r.default.createElement(b,null,this.renderSingleItem(o,0,null,{showAsHeader:!0,id:e}),this.renderChildrenOfItemAsGroup(o,0));else if(this.props.rootStyle===T.StaticHeader)e=this.getValidHTMLIdForItem(o),t=r.default.createElement(b,null,r.default.createElement(y,{item:o,id:e}),this.renderChildrenOfItemAsGroup(o,0));else{if(this.props.rootStyle!==T.None)throw new Error("Unknown root style: "+this.props.rootStyle);t=this.renderChildrenOfItemAsGroup(this.props.tree.rootItem,0)}if(this.state.selectedItemKey){var l=this.props.tree.items.get(this.state.selectedItemKey);i=this.getValidHTMLIdForItem(l)}return r.default.createElement("div",{role:"tree",tabIndex:0,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:n.default("tree-view","ax-focusable",{"is-focused":this.state.showFocused}),"aria-labelledby":e||void 0,"aria-activedescendant":i},t,this.props.children)},t.defaultProps={rootStyle:T.None,onItemSelected:function(e){},onItemExpanded:function(e,t){},treeItemView:I},t})(r.default.Component);t.TreeView=h.requireCssWithComponent(L,["/static/css/react/tree_view-vfltE0_vb.css","/static/css/accessibility-vfliGZNRm.css"]),(function(e){e.BRIEFCASE="s_briefcase",e.HOUSE="s_house",e.DROPBOX="dropbox"})(w=t.RootIcon||(t.RootIcon={}));var M=(function(e){function t(t,i){var n=e.call(this,t)||this;return n.folderNsId=i,n}return i.__extends(t,e),t})(S);t.FolderTreeItem=M;var F=function(e){return new M({key:e.path,label:f.filename(e.path),canExpand:e.has_subdirs,icon:e.icon,disabled:e.read_only},e.contained_ns)},C=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._pendingAjaxRequest=null,t.state={showLoadingScreen:!1,tree:v.createWithRootItem(new S({key:"/",icon:t.props.rootIcon,label:t.props.treeRootName}))},t.asyncFetchSubFoldersForItem=function(e){var i=e===t.state.tree.rootItem;i&&t.setState({showLoadingScreen:!0}),t._pendingAjaxRequest&&t._pendingAjaxRequest.abort(),t._pendingAjaxRequest=t.props.mkAjaxRequest(e.key),Promise.resolve(t._pendingAjaxRequest).then((function(i){var n=t.parseFolderList(i),o=t.state.tree.setChildItems(e,n);t.setState({tree:o})})).catch(t.props.handleError).then((function(){if(null!=t._pendingAjaxRequest){t._pendingAjaxRequest=null,i&&(t.props.isLoadingAdditionalData||t.setState({showLoadingScreen:!1}));var e=l.findDOMNode(t.refs.treeView);e&&e.focus()}}))},t.handleItemSelected=function(e){null!==e&&(e instanceof M?t.props.onFolderSelected(e.key,e.folderNsId,e.icon):t.props.onFolderSelected(e.key,void 0,e.icon))},t.handleExpandButtonClick=function(e,i){i&&!t.state.tree.isParent(e)&&t.asyncFetchSubFoldersForItem(e)},t.renderLoadingMessage=function(){return r.default.createElement("span",{className:"tree-view__loading-label"},_.intl.formatMessage({id:"9fef95",defaultMessage:"Loading your folders…"}))},t}return i.__extends(n,e),n.prototype.componentDidMount=function(){this.asyncFetchSubFoldersForItem(this.state.tree.rootItem)},n.prototype.componentWillReceiveProps=function(e){e.isLoadingAdditionalData||e.isLoadingAdditionalData===this.props.isLoadingAdditionalData||this.setState({showLoadingScreen:!1})},n.prototype.componentWillUnmount=function(){this._pendingAjaxRequest&&(this._pendingAjaxRequest.abort(),this._pendingAjaxRequest=null)},n.prototype.parseFolderList=function(e){return e.map(F)},n.prototype.render=function(){var e=this.props.isRootSelectable?T.HeaderItem:T.StaticHeader;return r.default.createElement(t.TreeView,{ref:"treeView",tree:this.state.tree,rootStyle:e,onItemSelected:this.handleItemSelected,onItemExpanded:this.handleExpandButtonClick,resetSelectedItem:this.props.resetSelectedItem},this.state.showLoadingScreen?this.renderLoadingMessage():void 0)},n.defaultProps={onFolderSelected:function(e,t,i){},handleError:function(e){E.Notify.error(_.intl.formatMessage({id:"dFFA0Z",defaultMessage:"An error occurred while trying to load your folder."}))}},n})(r.default.Component),D=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t})(C);t.FolderTreeView=D;var N=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.parseFolderList=function(e){var t=this,i=-1,n=e.map((function(e,n){var o=e.path;return t.props.pinnedFolder&&o===t.props.pinnedFolder&&(i=n),F(e)}));if(-1!==i){var o=n[i];n.splice(i,1),n.unshift(o)}return n},t})(C);t.PinnedFolderTreeView=N,t.AdminFolderTreeView=function(e){var t=e.mkAjaxRequest||function(t){return(function(e,t,i){var n={ns_id:i,ns_path:t,hide_tmfs:!0};return u.WebRequestOref({url:"/browse_util/tree_view_team_folder_contents",type:"POST",subject_user:e,data:n,dataType:"json"})})(e.userId,t,e.rootNSID)};return r.default.createElement(D,i.__assign({},e,{rootIcon:w.DROPBOX,mkAjaxRequest:t}))},t.UserFolderTreeView=function(e){var t=e.mkAjaxRequest||function(t){return(function(e,t){var i={folder:t};return u.WebRequestOref({url:"/browse_util/tree_view_folders",type:"POST",subject_user:e,data:i,dataType:"json"})})(e.user.id,t)},n=e.forceRootSelectable||"edit"===e.user.user_root_permissions,o=e.is_paired?e.user.is_team?w.BRIEFCASE:w.HOUSE:w.DROPBOX,l=i.__assign(i.__assign({},e),{mkAjaxRequest:t,isRootSelectable:n,rootIcon:o});if(e.user.is_cdm_member){var a=e.user.cdm_tmf_path;return r.default.createElement(N,i.__assign({},l,{pinnedFolder:a}))}return r.default.createElement(D,i.__assign({},l))}})),define("modules/clean/react/files_view/constants",["require","exports","modules/clean/react/files_view/types","modules/core/i18n"],(function(e,t,i,n){"use strict";var o,r,l,a;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultViewTypes=t.IMAGE_THUMBNAIL_EXTENSIONS=t.VIEW_TYPE_SCOPE_IMAGE_SEARCH=t.VIEW_TYPE_SCOPE_TEXT_SEARCH=t.VIEW_TYPE_GLOBAL_SCOPE=t.VIEW_TYPE_STORAGE_KEY=t.COLUMNS_STORAGE_KEY=t.VIEW_TYPE_COOKIE_NAME=t.OverflowMenuConstants=t.CulledListConstants=t.ViewTypeGridSizes=t.ViewTypeThumbnailSizes=t.AllSortDirections=t.AllLoadingStates=t.SortIsFilename=t.AllSortFields=t.AllDropTargetHighlightModes=t.ViewTypeLabels=t.AllViewTypes=t.AllRenameStates=t.AllNewFolderCreationStates=t.FilesViewTileGridConstants=t.SEARCH_LIST_VIEW_COLUMNS_DELETED=t.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS=t.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS=t.SEARCH_LIST_VIEW_COLUMNS=t.GRID_VIEW_COLUMNS=t.LIST_VIEW_COLUMNS=t.GRID_VIEW_COLUMN_FLEX=t.COLUMN_MAX_WIDTHS=t.COLUMN_MIN_WIDTHS=t.COLUMN_DEFAULT_WIDTHS=t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX=t.FILE_NAME_CELL_SEARCH_FLEX_BASIS=t.LIST_VIEW_COLUMN_FLEX=t.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH=t.CHECKBOX_CELL_FLEX=t.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP=t.COMPACT_COLUMN_HEADER_HEIGHT=t.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS=t.MEDIA_CELL_ICON_WIDTH=t.SNIPPET_HORIZONTAL_PADDING=t.SNIPPET_HEIGHT_PER_ROW=t.ROW_SNIPPET_VERTICAL_MARGIN=t.ROW_VERTICAL_PADDING=t.ROW_SUBTITLE_HEIGHT=t.ROW_TITLE_HEIGHT=t.DEFAULT_ROW_HEIGHT_CONDENSED_LIST=t.DEFAULT_ROW_HEIGHT_DENSE=t.DEFAULT_ROW_HEIGHT=t.DEFAULT_COLUMN_HEADER_HEIGHT=void 0;var s=n.intl.formatMessage({id:"P+XAua",defaultMessage:"Name"});t.DEFAULT_COLUMN_HEADER_HEIGHT=40,t.DEFAULT_ROW_HEIGHT=72,t.DEFAULT_ROW_HEIGHT_DENSE=60,t.DEFAULT_ROW_HEIGHT_CONDENSED_LIST=40,t.ROW_TITLE_HEIGHT=24,t.ROW_SUBTITLE_HEIGHT=16,t.ROW_VERTICAL_PADDING=16,t.ROW_SNIPPET_VERTICAL_MARGIN=8,t.SNIPPET_HEIGHT_PER_ROW=16,t.SNIPPET_HORIZONTAL_PADDING=16,t.MEDIA_CELL_ICON_WIDTH=64,t.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS=t.ROW_VERTICAL_PADDING+t.ROW_TITLE_HEIGHT+t.ROW_SUBTITLE_HEIGHT+t.ROW_SNIPPET_VERTICAL_MARGIN+3*t.SNIPPET_HEIGHT_PER_ROW,t.COMPACT_COLUMN_HEADER_HEIGHT=48,t.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP=12,t.CHECKBOX_CELL_FLEX="0 0 36px",t.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH=65,t.LIST_VIEW_COLUMN_FLEX={3:[t.CHECKBOX_CELL_FLEX,"1 1 50%","0 0 25%","0 0 25%"],2:[t.CHECKBOX_CELL_FLEX,"1 1 60%","0 0 40%"],1:[t.CHECKBOX_CELL_FLEX,"1 1 100%"]},t.FILE_NAME_CELL_SEARCH_FLEX_BASIS={3:50,2:65,1:100},t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX={3:[t.CHECKBOX_CELL_FLEX,"1 1 "+t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[3]+"%","0 0 25%","0 0 25%"],2:[t.CHECKBOX_CELL_FLEX,"1 1 "+t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[2]+"%","0 0 35%"],1:[t.CHECKBOX_CELL_FLEX,"1 1 "+t.FILE_NAME_CELL_SEARCH_FLEX_BASIS[1]+"%"]},t.COLUMN_DEFAULT_WIDTHS={FILENAME:300,MODIFIED:160,CATEGORY:160,EXTENSION:160,SIZE:160,SHARED_WITH:160,SYNC_SETTING:160,FILE_COUNTS:160,RELEVANCE:0,LOCKED_FILES:160,POLICY:160},t.COLUMN_MIN_WIDTHS={FILENAME:200,MODIFIED:100,CATEGORY:100,EXTENSION:100,SIZE:100,SHARED_WITH:100,SYNC_SETTING:100,FILE_COUNTS:100,RELEVANCE:0,LOCKED_FILES:100,POLICY:100},t.COLUMN_MAX_WIDTHS={FILENAME:1200,MODIFIED:200,CATEGORY:300,EXTENSION:300,SIZE:200,SHARED_WITH:300,SYNC_SETTING:300,FILE_COUNTS:300,RELEVANCE:0,LOCKED_FILES:300,POLICY:300},t.GRID_VIEW_COLUMN_FLEX=[t.CHECKBOX_CELL_FLEX,"1 1"],t.LIST_VIEW_COLUMNS=[{sortField:i.SortField.FILENAME,label:s,popoverTriggerLabel:s,isLocked:!0},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"})},{sortField:i.SortField.SHARED_WITH,label:n.intl.formatMessage({id:"HLRJwR",defaultMessage:"Members"}),popoverTriggerLabel:n.intl.formatMessage({id:"HLRJwR",defaultMessage:"Members"}),isSortOrderOptionDisabled:!0},{sortField:i.SortField.CATEGORY,label:n.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),popoverTriggerLabel:n.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"})},{sortField:i.SortField.EXTENSION,label:n.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),popoverTriggerLabel:n.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"})},{sortField:i.SortField.SIZE,label:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"})}],t.GRID_VIEW_COLUMNS=[{sortField:i.SortField.FILENAME,label:s,popoverTriggerLabel:s},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"})},{sortField:i.SortField.CATEGORY,label:n.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"}),popoverTriggerLabel:n.intl.formatMessage({id:"Pet0Vl",defaultMessage:"Type"})},{sortField:i.SortField.EXTENSION,label:n.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"}),popoverTriggerLabel:n.intl.formatMessage({id:"ZZCH08",defaultMessage:"Extension"})},{sortField:i.SortField.SIZE,label:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"})}],t.SEARCH_LIST_VIEW_COLUMNS=[{sortField:i.SortField.FILENAME,label:s,popoverTriggerLabel:s,isLocked:!0,isSortDisabled:!0},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),popoverTriggerLabel:n.intl.formatMessage({id:"GaUyyL",defaultMessage:"Modified"}),isLocked:!0,isSortDisabled:!0},{sortField:i.SortField.SIZE,label:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),isLocked:!0,isSortDisabled:!0}],t.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS=[{sortField:i.SortField.FILENAME,label:s,popoverTriggerLabel:s,isLocked:!0,isSortDisabled:!0},{sortField:i.SortField.RELEVANCE,label:n.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),popoverTriggerLabel:n.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),isLocked:!1,isSortDisabled:!1},{sortField:i.SortField.SIZE,label:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),popoverTriggerLabel:n.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}),isLocked:!0,isSortDisabled:!0},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),popoverTriggerLabel:n.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),isLocked:!1,isSortDisabled:!1}],t.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS=[{sortField:i.SortField.RELEVANCE,label:n.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),popoverTriggerLabel:n.intl.formatMessage({id:"3LcPUk",defaultMessage:"Relevance"}),isLocked:!1,isSortDisabled:!1},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),popoverTriggerLabel:n.intl.formatMessage({id:"QqPUpX",defaultMessage:"Last modified"}),isLocked:!1,isSortDisabled:!1}],t.SEARCH_LIST_VIEW_COLUMNS_DELETED=[{sortField:i.SortField.FILENAME,label:s,popoverTriggerLabel:s,isLocked:!0,isSortDisabled:!0},{sortField:i.SortField.MODIFIED,label:n.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"}),popoverTriggerLabel:n.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"}),isLocked:!0,isSortDisabled:!0}],t.FilesViewTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.AllNewFolderCreationStates=[i.NewFolderCreationState.CREATE_FOLDER_INACTIVE,i.NewFolderCreationState.PENDING_INPUT,i.NewFolderCreationState.SAVING_INPUT],t.AllRenameStates=[i.RenameState.PENDING_INPUT,i.RenameState.SAVING_INPUT],t.AllViewTypes=[i.ViewType.Grid,i.ViewType.LargeGrid,i.ViewType.List,i.ViewType.CondensedList],t.ViewTypeLabels=((o={})[i.ViewType.Grid]=n.intl.formatMessage({id:"x0/ZcU",defaultMessage:"Small"}),o[i.ViewType.List]=n.intl.formatMessage({id:"of/6qv",defaultMessage:"List"}),o[i.ViewType.CondensedList]=n.intl.formatMessage({id:"kiJCvJ",defaultMessage:"Condensed List"}),o[i.ViewType.LargeGrid]=n.intl.formatMessage({id:"c4/R0k",defaultMessage:"Large"}),o),t.AllDropTargetHighlightModes=[i.DropTargetHighlightMode.NONE,i.DropTargetHighlightMode.ALL_FOLDERS,i.DropTargetHighlightMode.NONSELECTED_FOLDERS,i.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS,i.DropTargetHighlightMode.NONSELECTED_NONSHARED_NONTEAM_FOLDERS],t.AllSortFields=[i.SortField.FILENAME,i.SortField.MODIFIED,i.SortField.CATEGORY,i.SortField.EXTENSION,i.SortField.SIZE,i.SortField.SHARED_WITH,i.SortField.SYNC_SETTING,i.SortField.FILE_COUNTS],t.SortIsFilename=[i.SortField.FILENAME,i.SortField.CATEGORY,i.SortField.EXTENSION,i.SortField.SHARED_WITH,i.SortField.SYNC_SETTING],t.AllLoadingStates=[i.LoadingState.LOADED,i.LoadingState.LOADING_FIRST_PAGE,i.LoadingState.LOADING_REMAINING_PAGES,i.LoadingState.LOAD_ERROR],t.AllSortDirections=[i.SortDirection.ASCENDING,i.SortDirection.DESCENDING],t.ViewTypeThumbnailSizes=((r={})[i.ViewType.Grid]=256,r[i.ViewType.LargeGrid]=512,r[i.ViewType.List]=32,r),t.ViewTypeGridSizes=((l={})[i.ViewType.Grid]=160,l[i.ViewType.LargeGrid]=480,l[i.ViewType.List]=0,l),t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.OverflowMenuConstants={MENU_ITEM_HEIGHT_PX:32,MENU_MARGIN_PX:8,MENU_POPOVER_ITEM_GROUP_SEPARATOR_HEIGHT_PX:17},t.VIEW_TYPE_COOKIE_NAME="browse_view_type",t.COLUMNS_STORAGE_KEY="browse_columns",t.VIEW_TYPE_STORAGE_KEY="files_view_types",t.VIEW_TYPE_GLOBAL_SCOPE="*",t.VIEW_TYPE_SCOPE_TEXT_SEARCH=":search/text",t.VIEW_TYPE_SCOPE_IMAGE_SEARCH=":search/image",t.IMAGE_THUMBNAIL_EXTENSIONS=["jpg","jpeg","png","tiff","tif","gif","bmp","webp","wbmp","psd","svg","svgz","ai","eps","otf","ttf","3gp","3gpp","3gpp2","asf","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","mxf","oggtheora","ogv","rm","ts","vob","webm","wmv","indd"],t.defaultViewTypes=((a={})[t.VIEW_TYPE_GLOBAL_SCOPE]=i.ViewType.List,a[t.VIEW_TYPE_SCOPE_TEXT_SEARCH]=i.ViewType.List,a[t.VIEW_TYPE_SCOPE_IMAGE_SEARCH]=i.ViewType.LargeGrid,a)})),define("modules/clean/react/files_view/drag_drop/drag_and_drop",["require","exports","modules/clean/react/browse/models","modules/clean/react/files_view/util"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onFileDragEnterItem=t.cleanupExternalDragHandler=t.setupExternalDragHandler=void 0;var o=new n.ScopedEventHandlers(document);t.setupExternalDragHandler=function(e,t,i,n,r,l,a){o.add(e,"dragenter",(function(e){(t()||i())&&!e.target.closest(r)&&l()&&(a(null),n())}))},t.cleanupExternalDragHandler=function(e){o.remove(e,"dragenter")},t.onFileDragEnterItem=function(e,t,n,o,r,l,a,s){if(t||n)if(e.is_dir&&!(o&&n)){if(r)return;var d=l.isCurrentPathWriteable()&&!i.File.isReadOnlySharedFolder(e);a(e),s({path:e.fq_path,hasPermissionToUploadToFolder:d,isMovingIntoVault:Boolean(e.is_in_vault_folder)})}else a(null),s()}})),define("modules/clean/react/files_view/drag_drop/drag_to_select",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/files_view/types","modules/clean/react/selectable_list","external/lodash"],(function(e,t,i,n,o,r,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragToSelectController=t.shouldMouseDownInitiateDragToSelect=t.isItemInSelectArea=void 0,n=i.__importDefault(n),t.isItemInSelectArea=function(e,t){return!(e.top+e.height<t.top||e.top>t.top+t.height||e.left+e.width<t.left||e.left>t.left+t.width)},t.shouldMouseDownInitiateDragToSelect=function(e,n,o,r){return!d(e)&&(e.target===e.currentTarget||(null==o||!o.selected||!o.selected.some((function(e){return r[e]&&t.isItemInSelectArea(r[e],i.__assign(i.__assign({},n),{height:0,width:0}))}))))};var s=a.throttle((function(e,i,n,o,a){Object.keys(e).forEach((function(s){t.isItemInSelectArea(e[s],i)?(null==a?void 0:a.selected.has(s))||n(s,l.SelectOptions.DEFAULT,r.FilesViewActionSource.DRAG_TO_SELECT):(null==a?void 0:a.selected.has(s))&&o(s,!1,r.FilesViewActionSource.DRAG_TO_SELECT)}))}),25),d=function(e){for(var t=e.target;t instanceof Node&&t!==e.currentTarget;){if(!0===t.draggable)return!0;t=t.parentElement}return!1};t.DragToSelectController=o.requireCssWithComponent((function(e){var i=n.default.useState(!1),o=i[0],l=i[1],d=n.default.useState(!1),c=d[0],u=d[1],p=n.default.useState(0),f=p[0],m=p[1],h=n.default.useRef(null),g=n.default.useRef({}),_=n.default.useState({top:0,left:0}),E=_[0],T=_[1],S=n.default.useState({top:0,left:0,width:0,height:0}),v=S[0],b=S[1];n.default.useEffect((function(){var e=a.throttle(I,8);return c&&(window.document.addEventListener("mouseup",w),window.document.addEventListener("mousemove",e)),function(){window.document.removeEventListener("mousemove",e),window.document.removeEventListener("mouseup",w)}}),[c,o]),n.default.useEffect((function(){return window.document.addEventListener("click",y,!0),function(){window.document.removeEventListener("click",y,!0)}}),[f]),n.default.useEffect((function(){o&&s(g.current,v,e.handleSelect,e.handleDeselect,e.selection)}),[o,v,e.selection]);var I=function(t){var i;if(c){if(1!==t.buttons)return u(!1),void l(!1);var n=null===(i=h.current)||void 0===i?void 0:i.getBoundingClientRect(),a=t.clientX-((null==n?void 0:n.left)||0),s=t.clientY-((null==n?void 0:n.top)||0);s<0&&(s=0),a<0&&(a=0),n&&a-10>n.width&&(a=n.width-10),n&&s-20>n.height&&(s=n.height-20);var d={top:Math.min(E.top,s),left:Math.min(E.left,a),height:Math.abs(E.top-s),width:Math.abs(E.left-a)};!o&&d.width<=5&&d.height<=5||(o?o&&b(d):(t.preventDefault(),e.updateSelection([],r.FilesViewActionSource.DRAG_TO_SELECT,!0),b(d),l(!0)))}},w=function(e){c&&(o&&m(Date.now()),l(!1),u(!1),b({top:0,left:0,width:0,height:0}),T({top:0,left:0}),e.preventDefault())},y=function(e){Date.now()-f<50&&e.preventDefault(),window.document.removeEventListener("click",y,!0)};if(!e.isDragToSelectEnabled){return n.default.createElement("div",null,e.children({registerSelectableItem:function(e,t){}}))}return n.default.createElement("div",{className:"files-view_drag-to-select",onMouseDown:function(i){var n;if(!i.isDefaultPrevented()&&!c&&1===i.buttons){var o=null===(n=h.current)||void 0===n?void 0:n.getBoundingClientRect(),r=i.clientX-((null==o?void 0:o.left)||0),l=i.clientY-((null==o?void 0:o.top)||0);t.shouldMouseDownInitiateDragToSelect(i,{top:l,left:r},e.selection,g.current)&&(T({top:l,left:r}),b({top:l,left:r,width:0,height:0}),u(!0))}},ref:h},n.default.createElement("div",{className:"files-view_drag-to-select-removal"},e.children({registerSelectableItem:function(e,t){var i,n=t.top+40,o=null===(i=h.current)||void 0===i?void 0:i.getBoundingClientRect();if(o){var r=t.width||o.width;g.current[e]={top:n,width:r,left:t.left,height:t.height}}}})),o&&n.default.createElement("div",{className:"files-view_select-box",style:{top:v.top+"px",left:v.left+"px",width:v.width+"px",height:v.height+"px"}}))}),["/static/css/files_view/drag_to_select-vflMvddNq.css"])})),define("modules/clean/react/files_view/file_jump",["require","exports","tslib","modules/clean/keycode","modules/core/dom"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleKeyPress=void 0,o=i.__importStar(o);var r=["/","\\",":","?","*","<",">","|"],l=null;t.handleKeyPress=function(e,t,i,a){var s=null!=e.which?e.which:e.keyCode,d=String.fromCharCode(s);s<n.KeyCode.SPACE||r.includes(d)||!document.activeElement.closest(".brws-checkbox-cell")&&o.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||s===n.KeyCode.SPACE&&!t()||(s===n.KeyCode.SPACE&&t()&&e.preventDefault(),i(d),null!=l&&clearTimeout(l),l=setTimeout((function(){a()}),1e3))}})),define("modules/clean/react/files_view/file_list_empty_folder_table",["require","exports","tslib","immutable","external/lodash","react","spectrum/media_table","spectrum/table","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/types"],(function(e,t,i,n,o,r,l,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyFolderTable=void 0,n=i.__importStar(n),o=i.__importStar(o),r=i.__importDefault(r);t.EmptyFolderTable=function(e){var t=e.subtitle,i=e.subtitleLink,c=e.subtitleOnClick,u=e.numRowsAbove,p=void 0===u?2:u,f=e.totalRows,m=void 0===f?14:f,h=e.title,g=e.onTTI,_=e.onFocusSearchBar,E=void 0===_?o.noop:_,T=e.onNavigateToParentFolder,S=void 0===T?o.noop:T,v=e.onOpenKeyboardShortcutModal,b=void 0===v?o.noop:v,I=e.onPasteFromClipboard,w=void 0===I?o.noop:I,y=r.default.useRef(null);r.default.useEffect((function(){return null==g||g(),s.setupFilesViewKeyboardShortcuts({viewType:d.ViewType.List,getIsGlobalEvent:s.generateGetIsGlobalEventForRef(y),getIsItemEvent:function(){return!1},getSelectedFiles:function(){return n.OrderedMap()},isCurrentPathWriteable:function(){return!1},selectAllAction:o.noop,deselectAllAction:o.noop,onCopyToClipboard:o.noop,onCutToClipboard:o.noop,onDelete:o.noop,onFocusSearchBar:E,onNavigateToFileOrFolder:o.noop,onNavigateToParentFolder:S,onPasteFromClipboard:w,onShowRename:o.noop,scope:"EmptyFolderTable",onShowHelpMenu:function(){return b()}}),function(){s.resetFilesViewKeyboardShortcuts("EmptyFolderTable")}}),[]);for(var L=[],M=0;M<p;M++)L.push(r.default.createElement(l.MediaRow,{key:-M-1}));var F=[],C=Math.max(m-p-1,0);for(M=0;M<C;M++)F.push(r.default.createElement(l.MediaRow,{key:M+1}));var D=r.default.createElement("h3",{className:"u-font-strong empty-folder-table-title"},h);return r.default.createElement(a.Table,{role:"main","aria-atomic":"true","aria-live":"polite",className:"empty-folder-table",ref:y},r.default.createElement(a.TableHead,null),r.default.createElement(a.TableBody,null,L,r.default.createElement(l.MediaRow,{key:0},r.default.createElement(l.MediaCell,{className:"empty-folder-table-cell",title:D,subtitle:t&&i?r.default.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:i,onClick:c},t):t?r.default.createElement("span",{className:"empty-folder-table-subtitle"},t):void 0})),F))}})),define("modules/clean/react/files_view/file_list_utils",["require","exports","modules/clean/filetypes","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/sharing/browse_exports"],(function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExtensionsMenuDisabledForContext=t.isSharingDisabledForFile=t.shouldFileBeHighlightedDropTarget=void 0,t.shouldFileBeHighlightedDropTarget=function(e){var t=e.file,r=e.isSelected,l=e.dropTargetHighlightMode;if(l===n.DropTargetHighlightMode.NONE)return!1;if(!t.is_dir)return!1;if(o.File.isReadOnlySharedFolder(t))return!1;if(t.isDeleted)return!1;switch(l){case n.DropTargetHighlightMode.ALL_FOLDERS:return!0;case n.DropTargetHighlightMode.NONSELECTED_FOLDERS:return!r;case n.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:return!r&&t.type!==i.FileTypes.SHARED_FOLDER;case n.DropTargetHighlightMode.NONSELECTED_NONSHARED_NONTEAM_FOLDERS:return!r&&![i.FileTypes.SHARED_FOLDER,i.FileTypes.TEAM_SHARED_FOLDER].includes(t.type)}return!1},t.isSharingDisabledForFile=function(e){var t=e.context,n=e.file,l=(e.user,e.expVaultEnableViewOnlySharing),a=void 0!==l&&l,s=n.per_node_metadata,d=!!((null==s?void 0:s.link_node)||(null==s?void 0:s.suppress_ns_partition)||(null==s?void 0:s.suppress_shared_link));return n.isDeleted||n.is_dir&&r.shouldUsePublicFolderSharing(t.config,n.fq_path)||o.File.isTeamMemberFolder(n)||!o.File.canViewFileMembers(n,t)||t.isInsideVaultFolder&&!a||n.type===i.FileTypes.VAULT_FOLDER||n.type===i.FileTypes.SANDBOX||d},t.isExtensionsMenuDisabledForContext=function(e){return e.context.isInsideVaultFolder}})),define("modules/clean/react/files_view/file_thumb_store",["require","exports","tslib","react","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/react/files_view/files_view_hooks","modules/clean/react/icon/file_folder_icon","modules/clean/react/files_view/constants"],(function(e,t,i,n,o,r,l,a,s,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withThumbStore=t.ThumbStoreContext=t.ThumbStoreProvider=void 0,n=i.__importDefault(n),t.ThumbStoreProvider=function(e){var i=e.shouldPrewarm,u=e.path,p=e.children,f=e.items,m=s.useIsPostTTI(),h=n.default.useMemo((function(){return m?new r.GenericThumbStore:new o.BufferedThumbStore}),[u]);return n.default.useEffect((function(){if(i){var e=[];return null==f||f.slice(0,100).forEach((function(t){if(t instanceof a.File||t instanceof a.FileSharedWithMe){var i=d.getThumbnailUrlForItem(t.thumbnail_url_tmpl,c.ViewTypeThumbnailSizes[l.ViewType.Grid]);if(i){var n=h.bind_url(i,{onSuccess:function(){}});n&&e.push(n)}}})),function(){return e.forEach((function(e){return h.unbind_url(e)}))}}}),[u,f,h,i]),n.default.createElement(t.ThumbStoreContext.Provider,{value:h},p)},t.ThumbStoreContext=n.default.createContext(new r.GenericThumbStore),t.withThumbStore=function(e){return function(o){return n.default.createElement(t.ThumbStoreContext.Consumer,null,(function(t){return n.default.createElement(e,i.__assign({},o,{thumbStore:t}))}))}}})),define("modules/clean/react/files_view/keyboard_shortcuts",["require","exports","tslib","keymaster","react-dom","modules/clean/react/browse/action_logger","modules/clean/react/files_view/file_jump","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/undo","modules/core/browser_detection","modules/core/i18n","modules/core/notify"],(function(e,t,i,n,o,r,l,a,s,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetFileJumpKeyboardShortcuts=t.setupFileJumpKeyboardShortcuts=t.setupFilesViewKeyboardShortcuts=t.getActionsAndAttachLogging=t.resetFilesViewKeyboardShortcuts=t.generateGetIsGlobalEventForRef=t.generateGetIsGlobalEvent=t.FILES_VIEW_TILE_GRID_SHORTCUTS=t.FILES_VIEW_LIST_SHORTCUTS=t.FILES_VIEW_SHORTCUTS=void 0,n=i.__importDefault(n),o=i.__importStar(o),l=i.__importStar(l),d=i.__importStar(d),c=i.__importStar(c),t.FILES_VIEW_SHORTCUTS=[{key:u.intl.formatMessage({id:"kOb587",defaultMessage:"/"}),desc:u.intl.formatMessage({id:"vOBkFB",defaultMessage:"Search"})},{windowsKey:u.intl.formatMessage({id:"JD6thv",defaultMessage:"Ctrl + a"}),macKey:u.intl.formatMessage({id:"vXQEej",defaultMessage:"⌘ + a"}),desc:u.intl.formatMessage({id:"n7drWm",defaultMessage:"Select all files"})},{windowsKey:u.intl.formatMessage({id:"yY9fAj",defaultMessage:"Esc"}),macKey:u.intl.formatMessage({id:"yIq4Am",defaultMessage:"esc"}),desc:u.intl.formatMessage({id:"m7zp3J",defaultMessage:"Deselect all files"})},{windowsKey:u.intl.formatMessage({id:"BmNZ7+",defaultMessage:"Ctrl + c"}),macKey:u.intl.formatMessage({id:"L/3I1a",defaultMessage:"⌘ + c"}),desc:u.intl.formatMessage({id:"jD02CF",defaultMessage:"Copy selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"TeH7ne",defaultMessage:"Ctrl + x"}),macKey:u.intl.formatMessage({id:"Hjoc2x",defaultMessage:"⌘ + x"}),desc:u.intl.formatMessage({id:"JvfueH",defaultMessage:"Cut selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"pApXZD",defaultMessage:"Ctrl + v"}),macKey:u.intl.formatMessage({id:"1MiQRb",defaultMessage:"⌘ + v"}),desc:u.intl.formatMessage({id:"ORvNm9",defaultMessage:"Paste selected file(s) into the current folder"})},{key:u.intl.formatMessage({id:"u3d9dU",defaultMessage:"F2"}),desc:u.intl.formatMessage({id:"GrOPDo",defaultMessage:"Rename selected file"})},{windowsKey:u.intl.formatMessage({id:"kHlg2I",defaultMessage:"Delete"}),macKey:u.intl.formatMessage({id:"ZZU2Yr",defaultMessage:"delete"}),desc:u.intl.formatMessage({id:"45XRF8",defaultMessage:"Delete selected file(s)"})},{windowsKey:u.intl.formatMessage({id:"8X8aMD",defaultMessage:"Ctrl + z"}),macKey:u.intl.formatMessage({id:"10+RMZ",defaultMessage:"⌘ + z"}),desc:u.intl.formatMessage({id:"HGnEOI",defaultMessage:"Undo recent move/copy/rename/delete"})},{key:u.intl.formatMessage({id:"YQJt5v",defaultMessage:"?"}),desc:u.intl.formatMessage({id:"mFXmY0",defaultMessage:"Show keyboard shortcuts"})}],t.FILES_VIEW_LIST_SHORTCUTS=i.__spreadArrays([{key:u.intl.formatMessage({id:"lkVLik",defaultMessage:"↑"}),desc:u.intl.formatMessage({id:"Riu+zT",defaultMessage:"Select previous file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"5ojTma",defaultMessage:"↓"}),desc:u.intl.formatMessage({id:"li5upG",defaultMessage:"Select next file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"u6AlvH",defaultMessage:"←"}),desc:u.intl.formatMessage({id:"rJHa1d",defaultMessage:"Go up a folder"})},{key:u.intl.formatMessage({id:"LJ+WGg",defaultMessage:"→"}),desc:u.intl.formatMessage({id:"+WMBQW",defaultMessage:"Open folder"})}],t.FILES_VIEW_SHORTCUTS),t.FILES_VIEW_TILE_GRID_SHORTCUTS=i.__spreadArrays([{key:u.intl.formatMessage({id:"lkVLik",defaultMessage:"↑"}),desc:u.intl.formatMessage({id:"Xg+zFf",defaultMessage:"Select file in previous row (hold shift to select range)"})},{key:u.intl.formatMessage({id:"5ojTma",defaultMessage:"↓"}),desc:u.intl.formatMessage({id:"erVlBC",defaultMessage:"Select file in next row (hold shift to select range)"})},{key:u.intl.formatMessage({id:"u6AlvH",defaultMessage:"←"}),desc:u.intl.formatMessage({id:"Riu+zT",defaultMessage:"Select previous file (hold shift to select range)"})},{key:u.intl.formatMessage({id:"LJ+WGg",defaultMessage:"→"}),desc:u.intl.formatMessage({id:"li5upG",defaultMessage:"Select next file (hold shift to select range)"})}],t.FILES_VIEW_SHORTCUTS);var f="",m=new s.ScopedEventHandlers(document);function h(e,t){return function(i){e(i)&&(i.preventDefault(),"function"==typeof t&&t(i))}}function g(e){var t=e.user,i=e.viewType,n=e.getSelectedFiles,o=e.isCurrentPathWriteable,l=e.onShowHelpMenu,a=e.onDelete,s=e.onShowRename,c=e.onFocusSearchBar,f=e.onNavigateToFileOrFolder,m=e.onNavigateToParentFolder,h=e.selectAllAction,g=e.onCopyToClipboard,_=e.onCutToClipboard,E=e.onPasteFromClipboard,T=e.deselectAllAction,S=function(){var e=n(),t=e.some((function(e){return e.read_only}));if(1===e.size)if(o()&&!t){var i=e.first();i.isDeleted?p.Notify.error(u.intl.formatMessage({id:"CCUrto",defaultMessage:"Deleted files can’t be renamed."})):s(i)}else p.Notify.warning(u.intl.formatMessage({id:"jXim1P",defaultMessage:"You don’t have permission to rename files in this folder."}))},v=function(){var e=n();e.size&&a(e)},b=function(){d.performUndo()},I=function(){var e=n();1===e.size&&f(e.first())},w=function(){var e=n(),t=e.first();1===e.size&&t.is_dir&&f(t)},y=function(e,n){r.logKeyboardShortcutUsage({user_id:t?t.id:null,view_type:i,keyboard_shortcut_type:e}),n()};return{renameFile:function(){y("rename",S)},focusSearchBar:function(){y("search",c)},showHelpMenu:function(){y("help",l)},selectAll:function(){y("select-all",h)},copyToClipboard:function(){y("copy",g)},cutToClipboard:function(){y("cut",_)},deleteFiles:function(){y("delete",v)},pasteFromClipboard:function(){y("paste",E)},undoAction:function(){y("undo",b)},deselectFiles:function(){y("deselect",T)},navigateToFileOrFolder:function(){y("navigate-file-folder",I)},navigateToFolder:function(){y("navigate-folder",w)},navigateToParent:function(){y("navigate-parent",m)}}}t.generateGetIsGlobalEvent=function(e){return function(t){return!document.activeElement||document.activeElement===document.body||t.target instanceof Element&&o.findDOMNode(e).contains(t.target)}},t.generateGetIsGlobalEventForRef=function(e){return function(t){var i;return!document.activeElement||document.activeElement===document.body||t.target instanceof Element&&(null===(i=e.current)||void 0===i?void 0:i.contains(t.target))||!1}},t.resetFilesViewKeyboardShortcuts=function(e){var t;t=e,n.default.clearScope(t),n.default.setScope(f),m.remove(e,"keydown"),m.remove(e,"keyup")},t.getActionsAndAttachLogging=g,t.setupFilesViewKeyboardShortcuts=function(e){var t=e.scope,i=e.getIsItemEvent,o=e.getIsGlobalEvent;(f=n.default.getScope())!==t&&n.default.setScope(t);var r=g(e);n.default("f2",t,h(i,r.renameFile)),n.default("/",t,h(o,r.focusSearchBar)),n.default("shift+/",t,h(o,r.showHelpMenu)),n.default("escape",t,h(o,r.deselectFiles)),c.mac?(n.default("command+a",t,h(o,r.selectAll)),n.default("command+c",t,h(i,r.copyToClipboard)),n.default("backspace",t,h(i,r.deleteFiles)),n.default("command+v",t,h(o,r.pasteFromClipboard)),n.default("command+x",t,h(i,r.cutToClipboard)),n.default("command+z",t,h(o,r.undoAction))):(n.default("ctrl+a",t,h(o,r.selectAll)),n.default("ctrl+c",t,h(i,r.copyToClipboard)),n.default("delete",t,h(i,r.deleteFiles)),n.default("ctrl+v",t,h(o,r.pasteFromClipboard)),n.default("ctrl+x",t,h(i,r.cutToClipboard)),n.default("ctrl+z",t,h(o,r.undoAction))),e.viewType===a.ViewType.List&&(n.default("right",t,h(i,r.navigateToFolder)),n.default("left",t,h(o,r.navigateToParent)))},t.setupFileJumpKeyboardShortcuts=function(e){var t=e.scope,i=e.getIsFileJumping,o=e.onAddFileJumpKeyCode,r=e.onResetFileJump;m.add(t,"keypress",(function(e){n.default.getScope()===t&&l.handleKeyPress(e,i,o,r)}))},t.resetFileJumpKeyboardShortcuts=function(e){m.remove(e,"keypress")}})),define("modules/clean/react/files_view/name_input",["require","exports","tslib","react","modules/clean/keycode","modules/clean/react/files_view/types","dig-components/text_fields"],(function(e,t,i,n,o,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NameInput=void 0,n=i.__importDefault(n);var a=function(){},s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.inputRef=n.default.createRef(),t.handleDragStart=function(e){e.stopPropagation()},t.handleSubmit=function(e){e.preventDefault(),t.submitIfChanged(r.NameInputActionSource.SUBMIT)},t.handleKeyDown=function(e){e.keyCode===o.KeyCode.ESC?(e.preventDefault(),t.props.onCancel({source:r.NameInputActionSource.ESC})):e.keyCode===o.KeyCode.ENTER&&t.handleSubmit(e)},t.handleBlur=function(e){t.submitIfChanged(r.NameInputActionSource.BLUR)},t.handleClick=function(e){e.preventDefault(),t.props.onClick(e)},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.inputRef.current&&this.inputRef.current.focus(),window.requestAnimationFrame((function(){if(e.inputRef.current){var t=e.inputRef.current.value,i=e.props.ignoreFileExtension?t.length:t.lastIndexOf(".");i<0&&(i=t.length),e.inputRef.current.setSelectionRange(0,i)}}))},t.prototype.submitIfChanged=function(e){if(this.inputRef.current){var t=this.inputRef.current.value.trim();t===this.props.defaultValue?this.props.onCancel({source:e}):this.props.onSubmit(t)}},t.prototype.render=function(){return n.default.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},n.default.createElement(l.TextInput,{ref:this.inputRef,defaultValue:this.props.defaultValue,className:this.props.className,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},t.defaultProps={className:"",onCancel:a,onClick:a,onSubmit:a,idDir:null},t})(n.default.PureComponent);t.NameInput=s})),define("modules/clean/react/files_view/overflow_menu",["require","exports","tslib","react","classnames","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/react/async/loadable","modules/core/browser_detection","modules/core/i18n"],(function(e,t,i,n,o,r,l,a,s,d,c,u){"use strict";var p;Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewOverflowMenu=t.OverflowMenuSize=t.AsyncFilesViewMobileOverflowMenu=void 0,n=i.__importDefault(n),o=i.__importDefault(o),a=i.__importStar(a),t.AsyncFilesViewMobileOverflowMenu=d.Loadable({loader:function(){return new Promise((function(t,i){e(["modules/clean/react/files_view/mobile_overflow_menu"],t,i)})).then(i.__importStar).then((function(e){return e.FilesViewMobileOverflowMenu}))}}),(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(p=t.OverflowMenuSize||(t.OverflowMenuSize={}));var f=(function(e){function r(t){var i=e.call(this,t)||this;return i.handleSelection=function(e){e.performAction()},i.handleMenuToggle=function(e){var t=e.isOpen;if(t&&i.props.onMenuOpen&&i.props.onMenuOpen(),r.isDynamicProps(i.props)&&t){var n=i.props.getOverflowMenuActions(i.props.file,!!i.props.canDisplayFolderSizes);i.setState({actionSection:n})}},i.handlePreventMouseDown=function(e){e.preventDefault(),e.stopPropagation()},i.handleMobileMenuOpen=function(e){return function(t){i.handlePreventMouseDown(t),i.handleMenuToggle({isOpen:!0}),e()}},i.handleClick=function(e){return function(t){i.handlePreventMouseDown(t),e({})}},i.state={actionSection:r.isDynamicProps(t)?[]:t.actionSection},i}return i.__extends(r,e),r.prototype.render=function(){var e=this,l=this.props,a=l.isResponsive,d=l.size,u=l.showBorders,f=l.ariaHidden,h=(r.isDynamicProps(this.props)?this.props:{}).file,g=void 0===h?void 0:h,_=a&&c.is_mobile_or_tablet(),E=d===p.Small?"small":"standard";return n.default.createElement("div",{"aria-hidden":f?"true":void 0,className:"browse-overflow-menu"},_?n.default.createElement(t.AsyncFilesViewMobileOverflowMenu,{trigger:function(t){var i=t.openMobileMenu;return n.default.createElement(m,{onClick:e.handleMobileMenuOpen(i),showBorders:u,size:E})},file:g,actionSection:this.state.actionSection}):n.default.createElement(s.Menu.Wrapper,{onSelection:this.handleSelection,onToggle:this.handleMenuToggle,onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,isPortaled:!1},(function(t){var r=t.getTriggerProps,l=t.getContentProps,a=t.openMenu;return n.default.createElement(n.default.Fragment,null,n.default.createElement(m,{triggerProps:r(),onClick:e.handleClick(a),showBorders:u,size:E,tabIndex:f?-1:0}),n.default.createElement(s.Menu.Content,i.__assign({placement:"bottom-end"},l(),{className:"browse-overflow-menu-content"}),e.state.actionSection.map((function(e,t){return n.default.createElement(s.Menu.Segment,{key:"action-group-"+t},e.map((function(e,t){return n.default.createElement(s.Menu.ActionItem,{key:t+"-"+e.label,value:e,disabled:e.disabled,className:o.default("browse-overflow-menu-item",e.className)},e.label)})))}))))})))},r.isDynamicProps=function(e){return"file"in e},r.defaultProps={onMenuToggle:function(){},isResponsive:!0},r})(n.default.Component);t.FilesViewOverflowMenu=f;var m=function(e){var t=e.size,o=e.showBorders,s=e.onClick,d=e.tabIndex,c=e.triggerProps,p=u.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"});return n.default.createElement(r.IconButton,i.__assign({},c,{"aria-label":p,onClick:s,size:t,variant:o?"outline":"transparent",tabIndex:d}),n.default.createElement(l.UIIcon,{src:a.MoreHorizontalLine,size:t}))}})),define("modules/clean/react/files_view/overflow_menu_item_section",["require","exports","tslib","react","spectrum/popover"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OverflowMenuItemSection=void 0,n=i.__importDefault(n),t.OverflowMenuItemSection=function(e){var t=e.actionSection,r=e.showSeparators,l=void 0===r||r,a=e.renderItem;return 0===t.length?null:n.default.createElement(n.default.Fragment,null,t.map((function(e){return e.map((function(e,t){return n.default.createElement(n.default.Fragment,{key:t+"-"+e.label},a(e))}))})).reduce((function(e,t,r){return i.__spreadArrays(e,l?[n.default.createElement(o.PopoverItemGroupSeparator,{key:r})]:[],t)})))}})),define("modules/clean/react/files_view/star",["require","exports","tslib","react","modules/clean/react/async/loadable"],(function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarContainer=void 0,n=i.__importDefault(n),t.StarContainer=o.Loadable({loader:function(){return i.__awaiter(void 0,void 0,void 0,(function(){var t,o,r,l;return i.__generator(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(t,i){e(["modules/clean/react/starred/browse_exports"],t,i)})).then(i.__importStar)];case 1:return t=a.sent(),o=t.idTypePairFromStarrableItem,r=t.Star,l=t.StarredSource,[2,function(e){var t=e.item,i=e.user,a=e.className,s=e.onStarClick,d=e.isReadOnly,c=e.tabIndex,u=e.starButtonClassName,p=e.alwaysShowUnstarred,f=o(t),m=f.id,h=f.type;return n.default.createElement("div",{className:a},n.default.createElement(r,{id:m,key:"star",idType:h,isDir:Boolean(t.is_dir),user:i,onStarClick:s,source:l.BROWSE,isReadOnly:d,tabIndex:c,starButtonClassName:u,alwaysShowUnstarred:p}))}]}}))}))}})})),define("modules/clean/react/files_view/file_thumbnail",["require","exports","tslib","classnames","react","spectrum/file_icon/get_extension","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/icon/file_folder_icon","modules/clean/react/icon/lock_badge","modules/clean/user_education/react/user_education_effect","modules/clean/react/files_view/file_thumb_store"],(function(e,t,i,n,o,r,l,a,s,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileThumbnail=t.FileThumbnailComponentForTests=void 0,n=i.__importDefault(n);var p=(function(e){function t(t){var i=e.call(this,t)||this;i._thumbRequestId=null,i.handleThumbnailError=function(){i.setState({thumbnailSrc:null})};var n=t.thumbStore,o=t.file.thumbnail_url_tmpl;return i.state={thumbnailSrc:o?n.get_thumb(o):null},i}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchThumbnail(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.file.thumbnail_url_tmpl!==this.props.file.thumbnail_url_tmpl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e))},t.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded()},t.prototype.fetchThumbnail=function(e){var t=this,i=e.file,n=e.thumbStore,o=i.fq_path||i.filename||"",d=r.getExtension(o);if(d&&l.IMAGE_THUMBNAIL_EXTENSIONS.includes(d)){var c=s.getThumbnailUrlForItem(i.thumbnail_url_tmpl,this.props.thumbnailSize?this.props.thumbnailSize:l.ViewTypeThumbnailSizes[a.ViewType.List]);c&&(this._thumbRequestId=n.bind_url(c,{onSuccess:function(){t.setState({thumbnailSrc:n.get_thumb(c)})},onError:function(){t.handleThumbnailError()}}))}},t.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this._thumbRequestId&&(e.unbind_url(this._thumbRequestId),this._thumbRequestId=null),this.setState({thumbnailSrc:null})},t.prototype.render=function(){var e=this.props,t=e.file,i=e.showCDMUserEducationEffects,r=e.iconSize,l=this.state.thumbnailSrc,a=t.fq_path||t.filename;return l?o.default.createElement(d.LockBadge,{file:this.props.file,variant:"preview-small"},o.default.createElement("img",{alt:a,draggable:!1,className:n.default("brws-file-name-cell-icon","brws-file-name-cell-thumb"),src:l,onError:this.handleThumbnailError})):o.default.createElement(f,{file:t,showCDMUserEducationEffects:i,iconSize:r})},t})((o=i.__importDefault(o)).default.PureComponent);t.FileThumbnailComponentForTests=p,t.FileThumbnail=u.withThumbStore(p);var f=function(e){var t=e.file,n=e.showCDMUserEducationEffects,r=e.iconSize,l=r?{height:r.toString(),width:r.toString()}:{},a=o.default.createElement(s.FileOrFolderIcon,i.__assign({className:"brws-file-name-cell-icon",file:t,showPreview:!1},l));return n?o.default.createElement(c.UserEducationEffect,{containerName:"FileItemRow",name:"TMFIcon",useSpan:!0},a):a}})),define("modules/clean/react/files_view/tile_grid",["require","exports","tslib","classnames","immutable","react","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/star","modules/clean/react/files_view/tile_label_input","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/files_view/view_file_button","modules/clean/react/icon/file_folder_icon","modules/clean/react/maestro/components/tile_grid","modules/clean/react/selectable_list","modules/clean/react/sticky_position","modules/clean/react/title_bubble","modules/clean/web_user_action_events","modules/core/browser","modules/core/i18n"],(function(e,t,i,n,o,r,l,a,s,d,c,u,p,f,m,h,g,_,E,T,S,v,b,I,w,y,L,M,F){"use strict";function C(e){var t=e instanceof c.File?a.filename(e.fq_path):T.isFswm(e)?e.filename:e instanceof c.Paper?e.title:e.name;if(e instanceof c.File)switch(e.type){case s.FileTypes.FOLDER:t=F.intl.formatMessage({id:"C/gp+a",defaultMessage:"Folder, {alt}"},{alt:t});break;case s.FileTypes.PACKAGE:t=F.intl.formatMessage({id:"FhSkpL",defaultMessage:"Package, {alt}"},{alt:t});break;case s.FileTypes.SHARED_FOLDER:t=F.intl.formatMessage({id:"rWEPV0",defaultMessage:"Shared folder, {alt}"},{alt:t});break;case s.FileTypes.SANDBOX:t=F.intl.formatMessage({id:"+vbakm",defaultMessage:"Sandbox, {alt}"},{alt:t});break;case s.FileTypes.TEAM_SHARED_FOLDER:t=F.intl.formatMessage({id:"ZtOyAr",defaultMessage:"Team shared folder, {alt}"},{alt:t});break;case s.FileTypes.TEAM_MEMBER_FOLDER:t=F.intl.formatMessage({id:"1yRjbu",defaultMessage:"Team member folder, {alt}"},{alt:t});break;default:t=F.intl.formatMessage({id:"e8WrLw",defaultMessage:"File, {alt}"},{alt:t})}return t}function D(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewTileGrid=t.TileLabel=void 0,n=i.__importDefault(n),o=i.__importStar(o),r=i.__importDefault(r),a=i.__importStar(a),M=i.__importStar(M);var N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onStarClickCallback=function(e){var i=t.props,n=i.onStarClick,o=i.item;n&&n(o,e)},t}return i.__extends(t,e),t.prototype.render=function(){var e,t=this.props,i=t.fileRename,n=t.arePostTTIModulesLoaded,o=t.user,s=t.item,d=t.createRenameCancelHandler,p=t.createRenameSubmitHandler;if(e=s instanceof c.File?a.filename(s.fq_path):s instanceof c.FileSharedWithMe?s.filename:s instanceof c.Paper?s.title:s.name,s instanceof c.File&&i&&a.paths_are_equal(i.file.fq_path,s.fq_path)){if(i.state===E.RenameState.PENDING_INPUT)return r.default.createElement(_.TileLabelInput,{defaultValue:e,label:e,onCancel:d(s),onSubmit:p(s)});if(i.state===E.RenameState.SAVING_INPUT)return r.default.createElement(b.TileItemLabelText,{className:"tile-label__text--saving",label:F.intl.formatMessage({id:"OefYpa",defaultMessage:"Renaming…"})})}var f=l.Emstring.em_snippet(e,14,.5),m=n&&s instanceof c.File&&!c.File.isNoAccessSharedFolder(s),h=r.default.createElement(b.TileItemLabelText,{key:"label",label:f});if(e!==f){var T=e.length<=u.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?e:r.default.createElement("div",{className:"tile-label-tooltip"},e);h=r.default.createElement(y.TitleBubble,{content:T,position:w.StickyPosition.BOTTOM,className:"tile-label__title-bubble",key:"tooltip"},h)}var S=s instanceof c.File?this.onStarClickCallback:void 0,v=r.default.createElement(g.StarContainer,{item:s,user:o,className:"tile-star",key:"tileStar",onStarClick:S,tabIndex:-1});return r.default.createElement("span",null,[h,m&&!i&&v])},t})(r.default.PureComponent);t.TileLabel=N;var R=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tileGridRef=r.default.createRef(),t.state={inSelectMode:!1,selectedIds:o.Set(),menuOpenId:void 0},t.createRenameCancelHandler=function(e){return function(){t.props.onRenameCancel(e)}},t.createRenameSubmitHandler=function(e){return function(i){t.props.onRenameSubmit(e,i)}},t.logOverflowMenuOpen=function(){var e=t.props,i=e.selectedFiles,n=e.user,o=e.viewType,r=i?i.count((function(e){return e.is_dir})):0,l=i?i.count()-r:0;d.logContextMenuClick({uid:n.id,viewType:o,action_surface:L.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:l,numFoldersSelected:r})},t.hrefForItem=function(e,i){return i instanceof c.File?t.props.hrefForFile(e,i):i instanceof c.FileSharedWithMe?i.href:i.url},t.getTileItem=function(e,i){var n=t.props,o=n.activeDropTarget,l=n.isCreateFolderUIActive,a=n.isPhotosPage,s=n.items,d=n.selection,p=n.user,f=n.viewType,m=n.focusedFileIndex,h=n.disabledMultiselect,g=n.cutItems,_=n.isActionBarEnabled,b=t.state.menuOpenId,I=t.state.inSelectMode;if(l){if(0===e)return t.getCreateFolderTile();e-=1}var w=s.get(e);if(!w){var y="Placeholder "+e;return{altText:y,id:y,isViewOnly:!0,isDraggable:!1,isSelectable:!1}}var L=T.isFile(w)||T.isFswm(w),M=w,D=I&&L,N=m===e,R=D&&d.selected.some((function(e){return M instanceof c.FileSharedWithMe?M.file_id===e:M.fq_path===e})),O=t.createToggleSelectHandler(M,R),P=t.createClickHandler({item:w,inSelectModeAndIsFile:D,toggleSelectHandler:O}),A=t.createViewFileHandler(w,E.FilesViewActionSource.ROW_DOUBLE_CLICK),x=t.createViewFileHandler(w,E.FilesViewActionSource.ROW_TITLE),H=(T.isFile(w)||T.isFswm(w))&&I&&!_?r.default.createElement(S.ViewFileButton,{isVisible:N||a,onClick:t.createViewFileHandler(w,E.FilesViewActionSource.ROW_PREVIEW_ICON),className:"tile__action-button--view-file"}):!T.isFile(w)&&!T.isFswm(w)||I&&!_?void 0:t.renderTileOverflowMenu(w,i,a),k=t.renderLabelElement(e),V=C(w),G=w===o,B=t.hrefForItem(p,w),W=w instanceof c.File||w instanceof c.FileSharedWithMe?v.getThumbnailUrlForItem(w.thumbnail_url_tmpl,u.ViewTypeThumbnailSizes[f]):void 0;return{file:M,paper:w instanceof c.Paper?w:void 0,fileSharedWithMe:w instanceof c.FileSharedWithMe?w:void 0,id:c.itemId(w),labelNode:k,altText:V,thumbnailUrl:W,actionNode:H,onClick:P,onDoubleClick:A,onLabelClick:x,isDraggable:!a&&(R||!D),isViewOnly:h,isFocused:N,isSelectable:L,handleToggleSelect:O,checkboxAriaText:F.intl.formatMessage({id:"o3Djy2",defaultMessage:"Select tile"}),href:B,onDragEnter:a?void 0:t.createDragEnterHandler(M,R,G),onDragStart:a?void 0:t.createDragStartHandler(M,R,O),isCheckboxFocusable:a,isCutToClipboard:g&&T.isCutToClipboard(w,g),className:b===c.itemId(w)?"tile--hover-forced":void 0}},t.shouldFileBeHighlightedDropTarget=function(e,i){var n=t.props.dropTargetHighlightMode;return f.shouldFileBeHighlightedDropTarget({file:e,isSelected:i,dropTargetHighlightMode:n})},t.scrollIntoView=function(e,i){var n=e.top,o=e.bottom,r=t.props.viewportTopOffset,l=void 0===r?0:r,a=t.getScrollPane(),s=a.height,d=a.scrollTop,c=a.scrollTo,u=s-l,p=d+u;n<d?c(0,n):o>p&&c(0,i&&o-n<u/2?o-u/2:o-u)},t}return i.__extends(t,e),t.prototype.componentWillMount=function(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setSelectedTiles(this.props)},t.prototype.componentDidMount=function(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()},t.prototype.componentWillUnmount=function(){this.props.isPhotosPage||m.resetFileJumpKeyboardShortcuts(I.SELECTABLE_TILE_GRID_KEY_SCOPE),m.resetFilesViewKeyboardShortcuts(I.SELECTABLE_TILE_GRID_KEY_SCOPE),p.cleanupExternalDragHandler(I.SELECTABLE_TILE_GRID_KEY_SCOPE)},t.prototype.componentWillReceiveProps=function(e){e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0}))},t.prototype.componentDidUpdate=function(e){(e.createNewFolderState===E.NewFolderCreationState.PENDING_INPUT&&this.props.createNewFolderState===E.NewFolderCreationState.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items||e.starredState!==this.props.starredState)&&this.tileGridRef.current&&this.tileGridRef.current.forceUpdate(),e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():m.resetFilesViewKeyboardShortcuts(I.SELECTABLE_TILE_GRID_KEY_SCOPE))},t.prototype.getTotalNumItems=function(){var e=this.props,t=e.items,i=e.totalNumItems,n=e.isCreateFolderUIActive,o=Math.max(t.size,i);return n&&(o+=1),o},t.prototype.createToggleSelectHandler=function(e,t){var i=this,n=e instanceof c.FileSharedWithMe?e.file_id:e.fq_path;return function(e){var o=i.props,r=o.onDeselectFile,l=o.onSelectFile,a=Boolean(!("keyCode"in e)&&e.shiftKey);t?r(n,a):l(n,a?I.SelectOptions.EXTEND:I.SelectOptions.DEFAULT)}},t.prototype.renderTileOverflowMenu=function(e,t,i){var n=this,o=this.props,l=o.getOverflowMenuActions,a=o.arePostTTIModulesLoaded,s=o.inlineActions;return o.isActionBarEnabled&&s&&e instanceof c.File?r.default.createElement("div",{onClick:D},r.default.createElement(s,{file:e,className:"tile__action-button--overflow-menu",onOverflowMenuToggle:function(t){var i=t.isOpen;n.setState({menuOpenId:i?c.itemId(e):void 0})}})):a&&r.default.createElement(h.FilesViewOverflowMenu,{file:e,getOverflowMenuActions:l,size:h.OverflowMenuSize.Small,showBorders:!0,ariaHidden:!i,onMenuOpen:this.logOverflowMenuOpen})},t.prototype.renderLabelElement=function(e){var t=this.props,i=t.items,n=t.focusedFileIndex,o=t.user,l=t.fileRename,a=t.arePostTTIModulesLoaded,s=t.onStarClick,d=t.isPhotosPage,c=t.isActionBarEnabled;if(!d){var u=i.get(e);if(u){var p=this.state.inSelectMode,f=n===e;return r.default.createElement(N,{item:u,user:o,fileRename:l,arePostTTIModulesLoaded:a,onStarClick:s,inSelectMode:p,isTileFocused:f,createRenameCancelHandler:this.createRenameCancelHandler,createRenameSubmitHandler:this.createRenameSubmitHandler,isActionBarEnabled:c})}}},t.prototype.createViewFileHandler=function(e,t){var i=this;return function(n){if(n.preventDefault(),n.stopPropagation(),"click"===n.type){var o=n;if(0===o.button){var r=i.hrefForItem(i.props.user,e);if(T.hasModifierKey(o))return void M.open_tab(r)}}e instanceof c.File?i.props.onNavigateToFileOrFolder(e,{actionSource:t}):e instanceof c.FileSharedWithMe?i.props.onOpenFileSharedWithMe(e):e instanceof c.Paper&&i.props.onOpenPaper(e)}},t.prototype.createClickHandler=function(e){var t=this,i=e.item,n=(e.inSelectModeAndIsFile,e.toggleSelectHandler),o=i instanceof c.File||i instanceof c.FileSharedWithMe;return function(e){if(o){var r="keyCode"in e;if(e.preventDefault(),r)n(e);else{var l=i instanceof c.FileSharedWithMe?i.file_id:i.fq_path;t.props.onSelectFile&&(e.shiftKey?t.props.onSelectFile(l,I.SelectOptions.EXTEND):e.ctrlKey||e.metaKey?n(e):t.props.onSelectFile(l,I.SelectOptions.ONLY))}}}},t.prototype.setSelectedTiles=function(e){var t=o.Set().withMutations((function(t){e.selectedFiles.forEach((function(e){var i;t.add((i=e)instanceof c.FileSharedWithMe?i.file_id:i.fq_path)}))}));this.setState({selectedIds:t})},t.prototype.setupExternalDragHandler=function(){var e=this;p.setupExternalDragHandler(I.SELECTABLE_TILE_GRID_KEY_SCOPE,(function(){return!!e.props.isDraggingInternalFiles}),(function(){return!!e.props.isDraggingExternalFiles}),this.props.onSetFileUploaderPath,".tile",(function(){return e.props.activeDropTarget}),this.props.onSetDropTarget)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,i=t.user,n=t.viewType,o=t.onDelete,r=t.onShowRename,l=t.deselectAll,a=t.getIsCurrentPathWriteable,s=t.getIsFileJumping,d=t.onAddFileJumpKeyCode,c=t.onResetFileJump,u=t.onCopyToClipboard,p=t.onCutToClipboard,f=t.onFocusSearchBar,h=t.onPasteFromClipboard,g=t.selectAll,_=m.generateGetIsGlobalEvent(this),E=_;this.props.isPhotosPage||m.setupFileJumpKeyboardShortcuts({scope:I.SELECTABLE_TILE_GRID_KEY_SCOPE,getIsFileJumping:s,onAddFileJumpKeyCode:d,onResetFileJump:c}),m.setupFilesViewKeyboardShortcuts({user:i,viewType:n,getIsGlobalEvent:_,getIsItemEvent:E,getSelectedFiles:function(){return e.props.selectedFiles},isCurrentPathWriteable:a,selectAllAction:g,deselectAllAction:l,onCopyToClipboard:u,onCutToClipboard:p,onDelete:o,onFocusSearchBar:f,onPasteFromClipboard:h,onShowRename:r,onNavigateToFileOrFolder:function(){},onNavigateToParentFolder:function(){},scope:I.SELECTABLE_TILE_GRID_KEY_SCOPE,onShowHelpMenu:this.props.onOpenKeyboardShortcutModal})},t.prototype.createDragEnterHandler=function(e,t,i){var n=this;return function(o){n.props.onDragEnter(o,e,t,i)}},t.prototype.createDragStartHandler=function(e,t,i){var n=this;return function(o){t?n.props.onDragStart(o):(i(o),n.props.onDragStart(o,[e]))}},t.prototype.getCreateFolderTile=function(){var e=this.props,t=e.createNewFolderState,i=e.onNewFolderCancel,n=e.onNewFolderSubmit,o=F.intl.formatMessage({id:"pxGZm3",defaultMessage:"New folder"}),l=r.default.createElement("div",null);return t===E.NewFolderCreationState.PENDING_INPUT?(o=F.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),l=r.default.createElement(_.TileLabelInput,{label:o,onCancel:i,onSubmit:n})):t===E.NewFolderCreationState.SAVING_INPUT&&(o=F.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"}),l=r.default.createElement(b.TileItemLabelText,{className:"tile-label__text--saving",label:o})),{altText:o,id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:l}},t.prototype.getScrollPane=function(){var e=this.props.scrollContainer;if(e&&e.current){var t=e.current,i=t.clientHeight,n=t.scrollTop,o=t.scrollTo;return{height:i,scrollTop:n,scrollTo:o?o.bind(e.current):function(){}}}return{height:window.innerHeight,scrollTop:"scrollingElement"in window.document&&window.document.scrollingElement?window.document.scrollingElement.scrollTop:window.document.documentElement.scrollTop,scrollTo:window.scrollTo?window.scrollTo.bind(window):function(){}}},t.prototype.getWindow=function(){var e=this.props.scrollContainer;return e&&e.current?T.createFakeWindow(e.current):window},t.prototype.render=function(){var e=this.props,t=e.enableMaxHeightGrouping,i=e.sections,o=e.viewType,l=e.viewportTopOffset,a=e.scrollContainer,s=e.scrollPositionOffset,d=e.registerSelectableTile,c=n.default({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode,"file-tile-grid-container--click-to-select":!0}),p=new Set;return this.state.selectedIds.forEach((function(e){return p.add(e)})),a&&!a.current?null:r.default.createElement("div",{role:"grid","aria-multiselectable":"true"},r.default.createElement(b.InfiniteTileGrid,{key:"tileGrid",ref:this.tileGridRef,totalNumItems:this.getTotalNumItems(),containerClass:c,rowClass:"file-tile-row",enableMaxHeightGrouping:t,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:u.FilesViewTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:u.FilesViewTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:i.sectionStartIndices,sectionLabels:i.sectionLabels,showLabels:!this.props.isPhotosPage,contentOffset:l,getTileItem:this.getTileItem,selectedIds:p,handleTTI:this.props.onTTI,onRangeInView:this.props.onRangeInView,tilesPerRow:this.props.tilesPerRow,onTilesPerRowChange:this.props.onTilesPerRowChange,activeDropTarget:this.props.activeDropTarget,maxTileWidth:u.ViewTypeGridSizes[o],tileHeight:u.ViewTypeGridSizes[o],shouldFileBeHighlightedDropTarget:this.shouldFileBeHighlightedDropTarget,scrollToIndex:this.props.focusedFileIndex,scrollIntoView:this.scrollIntoView,scrollPositionOffset:s||0,window:this.getWindow(),registerSelectableTile:d}))},t.defaultProps={enableMaxHeightGrouping:!1},t})(r.default.PureComponent);t.FilesViewTileGrid=R})),define("modules/clean/react/files_view/tile_label_input",["require","exports","tslib","classnames","react","modules/clean/react/files_view/name_input"],(function(e,t,i,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileLabelInput=void 0,n=i.__importDefault(n),o=i.__importDefault(o),t.TileLabelInput=function(e){var t=n.default("tile-label-input",e.className),i=e.defaultValue||"";return o.default.createElement(r.NameInput,{className:t,defaultValue:i,label:e.label,onCancel:e.onCancel,onClick:function(e){e&&(e.stopPropagation(),e.preventDefault())},onSubmit:e.onSubmit})}})),define("modules/clean/react/files_view/util",["require","exports","tslib","retrieval-components/view-mode-toggle","modules/clean/filepath","modules/clean/pnm/utils","modules/clean/react/browse/models","modules/clean/react/files_view/types"],(function(e,t,i,n,o,r,l,a){"use strict";function s(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}Object.defineProperty(t,"__esModule",{value:!0}),t.isMobileMode=t.ScopedEventHandlers=t.isCutToClipboard=t.viewModeFromViewType=t.viewTypeFromViewMode=t.shouldClickDeselect=t.createFakeWindow=t.getFilename=t.isFswm=t.isFile=t.hasModifierKey=t.shouldHandleClick=void 0,o=i.__importStar(o),t.shouldHandleClick=function(e){return 0===e.button&&!s(e)},t.hasModifierKey=s,t.isFile=function(e){return e instanceof l.File},t.isFswm=function(e){return e instanceof l.FileSharedWithMe},t.getFilename=function(e){return t.isFile(e)?r.hasValidLinkNode(e.per_node_metadata)?o.filename_without_extension(o.filename(e.fq_path)):o.filename(e.fq_path):e.filename},t.createFakeWindow=function(e){return i.__assign(i.__assign({},window),{document:{documentElement:{get scrollHeight(){return e.scrollHeight},get scrollTop(){return e.scrollTop}},body:{get scrollTop(){return e.scrollTop}}},get innerHeight(){return e.clientHeight},get pageYOffset(){return e.scrollTop},addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),requestAnimationFrame:requestAnimationFrame.bind(window),cancelAnimationFrame:cancelAnimationFrame.bind(window),scrollTo:e.scrollTo?e.scrollTo.bind(e):function(){}})},t.shouldClickDeselect=function(e){if(e.defaultPrevented)return!1;for(var t=e.target;t instanceof Node&&t!==e.currentTarget;){if(0===t.tabIndex||t instanceof HTMLAnchorElement||t instanceof HTMLButtonElement||t instanceof HTMLInputElement||t instanceof HTMLLabelElement||"button"===t.getAttribute("role")||t.classList.contains("mc-popover"))return!1;t=t.parentElement}return!0},t.viewTypeFromViewMode=function(e){switch(e){case n.ViewMode.GRID:return a.ViewType.Grid;case n.ViewMode.TILE:return a.ViewType.LargeGrid;case n.ViewMode.CONDENSED_LIST:return a.ViewType.CondensedList;case n.ViewMode.LIST:return a.ViewType.List}},t.viewModeFromViewType=function(e){switch(e){case a.ViewType.Grid:return n.ViewMode.GRID;case a.ViewType.LargeGrid:return n.ViewMode.TILE;case a.ViewType.List:return n.ViewMode.LIST;case a.ViewType.CondensedList:return n.ViewMode.CONDENSED_LIST}},t.isCutToClipboard=function(e,t){if(!(e instanceof l.File))return!1;var i=t.get(e.fq_path);return Boolean(i&&i.file_id===e.file_id)};var d=(function(){function e(e){this.handlers={},this.element=e}return e.prototype.add=function(e,t,i){this.handlers[e]=this.handlers[e]||{},this.handlers[e][t]=i,this.element.addEventListener(t,i)},e.prototype.remove=function(e,t,i){this.handlers[e]&&this.handlers[e][t]&&(this.element.removeEventListener(t,i||this.handlers[e][t]),this.handlers[e][t]===i&&delete this.handlers[e][t])},e.prototype.removeAll=function(e){if(this.handlers[e])for(var t in this.handlers[e])this.handlers[e].hasOwnProperty(t)&&(this.element.removeEventListener(t,this.handlers[e][t]),delete this.handlers[e][t])},e})();t.ScopedEventHandlers=d,t.isMobileMode=function(e){return!e.isMatchedLarge&&!e.isMatchedMedium}})),define("modules/clean/react/files_view/view_file_button",["require","exports","tslib","react","dig-components/icons/src","dig-components/icons","dig-components/buttons","modules/core/i18n"],(function(e,t,i,n,o,r,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewFileButton=void 0,n=i.__importDefault(n),t.ViewFileButton=function(e){var t=e.isVisible,i=e.className,s=e.onClick;return n.default.createElement(l.IconButton,{variant:"transparent","aria-label":a.intl.formatMessage({id:"K8mY77",defaultMessage:"View File"}),onClick:s,tabIndex:t?void 0:-1,className:i},n.default.createElement(r.UIIcon,{src:o.ShowLine}))}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};define("modules/clean/react/file_viewer/async_controller",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncOpenPreview=t.showElementsBehindFileViewer=t.hideElementsBehindFileViewer=void 0;var i=[".maestro-chrome","#maestro-nav","#page-footer","#page-content","#page-header","#page-sidebar","#flash-upload-container","#maestro-header","#maestro-header-portal","#maestro-prompt",".snackbar-container","#onboarding-sidebar-pagelet"].join();t.hideElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(i)).forEach((function(e){e.style.display&&e.setAttribute("data-preview-old-display",e.style.display),e.style.display="none"}))},t.showElementsBehindFileViewer=function(){Array.from(document.querySelectorAll(i)).forEach((function(e){e.style.display=e.hasAttribute("data-preview-old-display")?e.getAttribute("data-preview-old-display"):""}))},t.asyncOpenPreview=function(t){var i=t.containerId,n=t.files,o=t.fileViewAction,r=t.fileViewOrigin,l=t.fileViewTarget,a=t.indexOfPreviewFile,s=t.onFileViewerDidMount,d=t.onFileViewerUnmount,c=(t.shouldFocusComment,t.shouldPresentInZoom),u=void 0!==c&&c,p=t.updateBrowserLocation,f=void 0===p||p,m=t.user;new Promise((function(t,i){e(["modules/clean/react/file_viewer/controller"],t,i)})).then(__importStar).then((function(e){e.open(n,a,m,i,{fileViewTarget:l,fileViewOrigin:r,fileViewAction:o,disableRouting:!f,onComponentDidMount:s,onComponentWillUnmount:d,shouldPresentInZoom:u})}))}})),define("modules/clean/react/maestro/components/tile_grid",["require","exports","tslib","classnames","react","resize-observer-polyfill","react-dom","spectrum/culled_list","modules/clean/filepath","modules/clean/js_client_stopwatch","modules/clean/react/maestro/components/tile_element","modules/clean/react/maestro/components/tile_grid_logger"],(function(e,t,i,n,o,r,l,a,s,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfiniteTileGrid=t.TileItemLabelText=t.memoizeCallback=void 0,n=i.__importDefault(n),o=i.__importDefault(o),r=i.__importDefault(r),l=i.__importStar(l),s=i.__importStar(s);function p(e){var t=null;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];if(!t||t.length!==i.length||!t.every((function(e,t){return e===i[t]})))return t=i,e.apply(void 0,i)}}t.memoizeCallback=p,t.TileItemLabelText=function(e){var t=e.className,i=e.label;return t=n.default("tile-label__text",t),o.default.createElement("div",{className:t},i)};var f=(function(e){function t(t){var i=e.call(this,t)||this;if(i.tileIndexToRowIndex=[],i.rowHeights=[],i.ttiReported=!1,i.itemRangeByRow=[],i.tileLoadLogger=null,i.handleResize=function(e){i.updateOnResize(e[0].contentRect.width)},i.updateScroll=function(e){var t=i.props,n=t.scrollToIndex,o=t.scrollIntoView,r=t.scrollPositionOffset;if(void 0!==n&&o){var l=i.tileIndexToRowIndex[n],a=i.rowHeights.slice(0,l).reduce((function(e,t){return e+t}),r);o({top:a,bottom:a+i.rowHeights[l]},e)}},i.updateOnResize=function(e){i.renameAnimationFrameRequestId&&cancelAnimationFrame(i.renameAnimationFrameRequestId),i.renameAnimationFrameRequestId=window.requestAnimationFrame((function(){i.getAndUpdateTileLayout(e)}))},i.handleTTI=function(){i.ttiReported=!0;var e=i.props.handleTTI;e&&e()},i.setLastViewedPage=function(e){if(i.tileLoadLogger){var t=document.documentElement.scrollTop||document.body.scrollTop,n=Math.round(t/e);if(i.tileLoadLogger.pruneTrackedPages(),i.tileLoadLogger.logCompletedPages(),!i.tileLoadLogger.pagesCompletedLogging.has(n)&&!i.tileLoadLogger.pagesToLog.has(n))if(n!==i.tileLoadLogger.lastViewedPage){if(i.tileLoadLogger.lastViewedPage=n,i.tileLoadLogger.pageChangeTime=i.tileLoadLogger.getTimeNow(),!i.tileLoadLogger.startTimeByPage.get(n)){var o=i.tileLoadLogger.getTimeNow();i.tileLoadLogger.startTimeByPage.set(n,o)}}else(o=i.tileLoadLogger.getTimeNow())-i.tileLoadLogger.pageChangeTime>1e3&&i.tileLoadLogger.pagesToLog.add(n)}},i.logTileError=function(e){i.tileLoadLogger&&i.tileLoadLogger.recordTileError(e),i.props.logTileLoading&&u.InfiniteTileGridLogger.logThumbLoadError()},i.logTileLoaded=function(e,t,n){i.tileLoadLogger&&i.tileLoadLogger.recordTileLoaded(e,t,n)},i.renderTileElement=function(e,t,n,r){var l,a;if(e<0||e>i.props.totalNumItems)return null;var d=i.props.getTileItem(e,n);if(!d)return o.default.createElement(c.TilePlaceholder,{leftOffset:t,tileHeight:i.state.tileWidth,tileWidth:i.state.tileWidth});var u,p=i.ttiReported&&i.props.delayRenderFullTile,f=d.isSelectable&&!!i.props.selectedIds&&i.props.selectedIds.has(d.id),m=d.file&&i.props.shouldFileBeHighlightedDropTarget(d.file,f),h=m&&d.file===i.props.activeDropTarget,g="";d.fileSharedWithMe?(g=d.fileSharedWithMe.file_id,u={type:d.fileSharedWithMe.type,icon:d.fileSharedWithMe.icon,fq_path:"/"+d.fileSharedWithMe.filename,thumbnail_url_tmpl:d.fileSharedWithMe.thumbnail_url_tmpl,name:d.fileSharedWithMe.filename}):d.file&&(g=d.file.fq_path,u={type:d.file.type,icon:d.file.icon,fq_path:d.file.fq_path,thumbnail_url_tmpl:d.file.thumbnail_url_tmpl,name:s.filename(d.file.fq_path),isDeleted:d.file.isDeleted,is_locked:d.file.is_locked,is_lockholder:d.file.is_lockholder,lockholder_name:d.file.lockholder_name,lock_info:d.file.lock_info});var _=d.labelNode?i.props.labelHeight:0;null===(a=(l=i.props).registerSelectableTile)||void 0===a||a.call(l,g,{top:r,left:t,width:i.state.tileWidth,height:_+i.state.tileWidth});var E=0===e&&i.props.selectedIds&&0===i.props.selectedIds.size;return o.default.createElement(c.TileElement,{file:u,paper:d.paper,key:d.id,onClick:d.onClick,onDoubleClick:d.onDoubleClick,onLabelClick:d.onLabelClick,width:i.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:_,delayRenderFullTile:p,actionNode:d.actionNode,thumbnailUrl:d.thumbnailUrl,labelNode:d.labelNode,altText:d.altText,onThumbnailError:i.props.logTileLoading?i.logTileError:void 0,onThumbnailLoad:i.props.logTileLoading?i.logTileLoaded:void 0,isDraggable:d.isDraggable,onDragEnter:d.onDragEnter,onDragStart:d.onDragStart,isFocused:d.isFocused,isSelectable:d.isSelectable,isSelected:f,isViewOnly:d.isViewOnly,isActiveDropTarget:h,isAvailableDropTarget:m,handleToggleSelect:d.handleToggleSelect,checkboxAriaText:d.checkboxAriaText,checkboxTabIndex:d.isCheckboxFocusable?0:-1,href:d.href,overrideTabIndex:E,isCutToClipboard:d.isCutToClipboard,className:d.className})},i.renderRow=function(e,t,n){var r=i.getRowHeight(t);if(!e)return o.default.createElement(a.CulledItem,{className:i.props.rowClass,height:r,key:t,tagName:"div",topOffset:n});if(!Array.isArray(e))return o.default.createElement(a.CulledItem,{className:i.props.rowClass,height:r,key:t,tagName:"div",topOffset:n},e);for(var l=e,s=l[0],d=l[1],c=i.state.tileWidth+i.props.tilePadding,u=[],p=4,f=s;f<d;f++)u.push(i.renderTileElement(f,p,u.length,n)),p+=c;return o.default.createElement(a.CulledItem,{className:i.props.rowClass,height:r,key:t,tagName:"div",topOffset:n},u)},i.handleRangeInView=p((function(e,t){var n=i.props.onRangeInView;if(n&&0!==i.props.totalNumItems){var o=i.translateRowRangeToItemRange(e,t),r=o[0],l=o[1];isNaN(r)||isNaN(l)||n(r,l)}})),i.props.sectionLabels||i.props.sectionStartIndices){if(!i.props.sectionLabels||!i.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(i.props.sectionLabels.length!==i.props.sectionStartIndices.length)throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return i.state={tileWidth:i.props.maxTileWidth},d.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),i.resizeObserver=new r.default(i.handleResize),i}return i.__extends(t,e),t.prototype.updateLayout=function(){var e=this;this.animationFrameRequestId=window.requestAnimationFrame((function(){var t=e.getAndUpdateTileLayout(e.getContainerWidth());e.props.logTileLoading&&!e.tileLoadLogger&&e.setupTileLogging(e.getRowHeight(),t.tilesPerRow)}))},t.prototype.getContainerWidth=function(){var e=l.findDOMNode(this);return e?e.clientWidth:0},t.prototype.componentDidMount=function(){var e=l.findDOMNode(this);e&&this.resizeObserver.observe(e),this.updateLayout(),this.updateScroll(!0)},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.totalNumItems),this.props.maxTileWidth!==e.maxTileWidth&&this.updateLayout()},t.prototype.componentDidUpdate=function(e){e.scrollToIndex!==this.props.scrollToIndex&&this.updateScroll(void 0===e.scrollToIndex||e.scrollToIndex<0)},t.prototype.componentWillUnmount=function(){this.resizeObserver.disconnect(),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.renameAnimationFrameRequestId&&window.cancelAnimationFrame(this.renameAnimationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),this.tileLoadLogger=null)},t.prototype.getRowHeight=function(e){if(void 0!==e&&this.rowHeights)return this.rowHeights[e];var t=this.state.tileWidth+this.props.tilePadding;return this.props.showLabels&&(t+=this.props.labelHeight+4),t},t.prototype.getPageHeight=function(){var e=(document.documentElement.clientHeight||window.outerHeight)-(this.props.contentOffset||0),t=this.getRowHeight(),i=t*Math.ceil(e/t);return Math.max(i,t)},t.prototype.getAndUpdateTileLayout=function(e){var t=this.props.maxTileWidth+this.props.tilePadding;if(0===e)return{tileWidth:this.state.tileWidth,tilesPerRow:this.props.tilesPerRow};var i=Math.max(1,Math.floor(e/t)),n=this.props.maxTileWidth;return e%t>1&&(n=e/++i-this.props.tilePadding),this.state.tileWidth!==n&&this.setState({tileWidth:n}),this.props.tilesPerRow!==i&&this.props.onTilesPerRowChange(i),{tileWidth:n,tilesPerRow:i}},t.prototype.setupTileLogging=function(e,t){var i=this.getPageHeight(),n=t*Math.ceil(i/e);this.tileLoadLogger=new u.InfiniteTileGridLogger(this.props.totalNumItems,n,t,this.handleTTI),this.tileLoadLogger.pagesToLog.add(0);var o=this.tileLoadLogger.getTimeNow();this.tileLoadLogger.startTimeByPage.set(0,o),this.logTrackingInterval=setInterval(this.setLastViewedPage,200,i)},t.prototype.translateRowRangeToItemRange=function(e,t){var i=this.itemRangeByRow;return[i[e][0],i[t][1]]},t.prototype.render=function(){var e=this;this.itemRangeByRow=[],this.rowHeights=[],this.tileIndexToRowIndex=[];var t=[],i=this.getRowHeight(),n=this.props,r=n.containerClass,l=n.enableMaxHeightGrouping,s=n.numThresholdRows,d=n.scrollDeltaThreshold,c=n.sectionStartIndices,u=n.sectionLabels,p=n.totalNumItems,f=n.window;if(c&&c.length>0)c.forEach((function(n,r){var l=p;r!==c.length-1&&(l=c[r+1]),e.rowHeights.push(32);var a=l-n,s=Math.ceil(a/e.props.tilesPerRow),d=u[r],f=o.default.createElement("div",{className:"tile-section-header",role:"heading","aria-level":2},d);t.push(f),e.itemRangeByRow.push([n,n]);for(var m=0;m<s;m++){var h=n+m*e.props.tilesPerRow,g=Math.min(h+e.props.tilesPerRow,l),_=[h,g];t.push(_),e.itemRangeByRow.push(_);for(var E=h;E<g;E++)e.tileIndexToRowIndex.push(e.rowHeights.length);e.rowHeights.push(i)}}));else for(var m=Math.ceil(p/this.props.tilesPerRow),h=0;h<m;h++){var g=h*this.props.tilesPerRow,_=Math.min(g+this.props.tilesPerRow,p),E=[g,_];t.push(E),this.itemRangeByRow.push(E);for(var T=g;T<_;T++)this.tileIndexToRowIndex.push(this.rowHeights.length);this.rowHeights.push(i)}return o.default.createElement(a.CulledList,{enableMaxHeightGrouping:l,items:t,listItemHeight:this.rowHeights,itemBuffer:s,className:r,renderRow:this.renderRow,scrollThreshold:d,shouldUseWindowAsScrollContainer:!0,onRangeInView:this.handleRangeInView,tagName:"div",window:f})},t.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:function(){return null},handleTTI:function(){}},t})(o.default.PureComponent);t.InfiniteTileGrid=f})),define("modules/clean/react/maestro/components/tile_element",["require","exports","tslib","classnames","react","dig-components/controls","modules/clean/keycode","modules/clean/paper_formatting_utils","modules/clean/react/files_view/double_click","modules/clean/react/icon/file_folder_icon","modules/clean/react/icon/lock_badge","modules/clean/react/maestro/components/tile_grid_logger","modules/clean/user_education/react/user_education_effect","modules/clean/react/files_view/file_thumb_store"],(function(e,t,i,n,o,r,l,a,s,d,c,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileElement=t.TileElementComponentForTests=t.TilePlaceholder=t.TileLabel=void 0,n=i.__importDefault(n),o=i.__importDefault(o),a=i.__importStar(a);var m=function(){return null};t.TileLabel=function(e){var t=e.ariaLabel,i=e.children,n=e.onClick;if(!i)return null;var r=o.default.createElement("div",{className:"tile-label","aria-hidden":"true"},i);return n?o.default.createElement("a",{onClick:n,tabIndex:-1,"aria-label":t},r):r},t.TilePlaceholder=function(e){var i=e.leftOffset,n=e.tileHeight,r=e.tileWidth,l=e.thumbNode,a=e.labelNode;return o.default.createElement("div",{className:"tile",style:{left:i,height:n,width:r,pointerEvents:"none"}},o.default.createElement("div",{className:"tile__thumb-container",style:{height:r,width:r}},l||o.default.createElement("div",{className:"tile__preview--placeholder"})),o.default.createElement(t.TileLabel,null,a))};var h=(function(e){function f(t){var n=e.call(this,t)||this;return n.thumbRequestId=null,n.animationRequestIds=[],n.handleThumbnailError=function(){var e=n.props,t=e.onThumbnailError,i=e.tileIndex;n.setState({thumbLoaded:!1}),t&&t(i)},n.logTileInteractive=function(){var e=!!n.props.thumbnailUrl,t=n.state.thumbLoaded;if(n.props.onThumbnailLoad){var i=window.requestAnimationFrame((function(){var i=window.requestAnimationFrame((function(){n.props.onThumbnailLoad(n.props.tileIndex,e,t)}));n.animationRequestIds.push(i)}));n.animationRequestIds.push(i)}},n.toggleSelect=function(e){e.stopPropagation(),n.props.handleToggleSelect(e)},n.handleKeyDown=function(e){var t=e.keyCode;e.currentTarget!==e.target||t!==l.KeyCode.SPACE&&t!==l.KeyCode.ENTER||(e.preventDefault(),n.props.onClick(e))},n.handleCheckboxChange=function(){},n.state=i.__assign({thumbLoaded:f.isThumbLoaded(t)},n.calcPaperTitleState(t)),n}return i.__extends(f,e),f.prototype.componentDidMount=function(){var e=this;this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout((function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail(e.props)}),100):this.fetchThumbnail(this.props),this.logTileInteractive()},f.prototype.componentDidUpdate=function(e,t){if(!e.isFocused&&this.props.isFocused){var i=this.refs.tileContainer;i&&i.focus()}},f.prototype.componentWillReceiveProps=function(e){if(e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e)),f.getPaperTitle(this.props)!==f.getPaperTitle(e)){var t=this.calcPaperTitleState(e);this.setState(t)}},f.getPaperTitle=function(e){return e.paper?e.paper.title:null},f.prototype.calcPaperTitleState=function(e){return e.paper?{paperTitleParts:a.getPaperDocTitleParts(e.paper,"brws-file-name-grid-icon","brws-file-name-grid-icon-emoji",!0)}:{}},f.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach((function(e){window.cancelAnimationFrame(e)})),this.animationRequestIds=[]},f.prototype.fetchThumbnail=function(e){var t=this,i=e.thumbnailUrl,n=e.thumbStore;if(i){var o=Date.now();this.thumbRequestId=n.bind_url(i,{onSuccess:function(){t.setState({thumbLoaded:!0}),u.InfiniteTileGridLogger.logThumbRTT(Date.now()-o)},onError:function(){t.handleThumbnailError()}})}},f.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this.thumbRequestId&&(e.unbind_url(this.thumbRequestId),this.thumbRequestId=null),this.setState({thumbLoaded:!1})},f.isThumbLoaded=function(e){var t=e.thumbStore,i=e.thumbnailUrl;return!(!i||!t.get_thumb(i))},f.prototype.renderCheckbox=function(){var e=o.default.createElement(r.Checkbox,{className:"tile-checkbox","aria-label":this.props.checkboxAriaText,onClick:this.toggleSelect,onChange:this.handleCheckboxChange,tabIndex:this.props.checkboxTabIndex,checked:this.props.isSelected});return 0===this.props.tileIndex&&(e=o.default.createElement(p.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox"},e)),o.default.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},e)},f.prototype.renderActionNode=function(){return o.default.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},f.prototype.renderThumbnail=function(){var e=this.props,t=e.thumbnailUrl,i=e.thumbStore,n=e.height,r=e.width,l=e.isSelected;if(this.state.thumbLoaded){var a=i.get_thumb(t);if(a){var s=l?r-24:r,d=n||s;return o.default.createElement(c.LockBadge,{file:this.props.file,variant:"preview-large"},o.default.createElement("img",{className:"tile__preview tile__preview--thumb",draggable:!1,src:a,style:{maxHeight:d,maxWidth:s},onError:this.handleThumbnailError,alt:""}))}}return this.renderFileIcon()},f.prototype.renderFileIcon=function(){var e=this.props,t=e.file;return e.paper?this.state.paperTitleParts.icon:t?o.default.createElement(d.FileOrFolderIcon,i.__assign({className:"tile__preview tile__preview--icon brws-file-name-grid-icon",file:t,variant:"large",showPreview:!1},{"aria-hidden":!0})):o.default.createElement("div",{className:"tile__preview--placeholder"})},f.prototype.render=function(){var e=this,r=this.props,l=r.altText,a=r.file,d=r.height,c=r.href,u=r.isActiveDropTarget,p=r.isAvailableDropTarget,f=r.isCutToClipboard,m=r.isDraggable,h=r.isFocused,g=r.isSelectable,_=r.isSelected,E=r.isViewOnly,T=r.labelHeight,S=r.labelNode,v=r.leftOffset,b=r.onClick,I=r.onDoubleClick,w=r.onLabelClick,y=r.onDragEnter,L=r.onDragStart,M=r.overrideTabIndex,F=r.width,C=r.className,D=d||F,N=D+T;if(E)return o.default.createElement(t.TilePlaceholder,{leftOffset:v,tileHeight:N,tileWidth:F,thumbNode:this.renderThumbnail(),labelNode:S});var R={left:v,height:N,width:F},O={height:D,width:F},P={className:n.default("tile",C,{"tile--is-selected":_,"tile--is-dragover":u,"tile--is-droppable":p&&!u,"tile--is-cut":f}),"data-filename":a&&a.name,style:R,draggable:m,href:c,onDragEnter:y,onDragStart:L,"aria-label":a&&a.name,role:"gridcell"},A=o.default.createElement("div",{className:"tile__thumb-container",style:O},this.renderThumbnail());return o.default.createElement("div",{role:"row",ref:"tileContainer",className:"tile__container",onKeyDown:this.handleKeyDown,tabIndex:M||h?0:-1,"aria-label":l,"aria-selected":_},o.default.createElement(s.WithDoubleClick,{onClick:b,onDoubleClick:I},(function(n){return o.default.createElement("div",i.__assign({},P,{onClick:n.onClick}),A,g&&e.renderCheckbox(),e.renderActionNode(),o.default.createElement(t.TileLabel,{onClick:w,ariaLabel:a&&a.name},S))})))},f.defaultProps={checkboxAriaText:"",checkboxTabIndex:-1,delayRenderFullTile:!0,handleToggleSelect:m,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:m,onDragStart:m,onClick:m},f})(o.default.PureComponent);t.TileElementComponentForTests=h,t.TileElement=f.withThumbStore(h)})),define("modules/clean/react/maestro/components/tile_grid_logger",["require","exports","modules/clean/js_client_stopwatch","modules/core/browser"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfiniteTileGridLogger=void 0;var o=(function(){function e(e,t,i,n){var o=this;this.recordTileError=function(e){var t=Math.floor(e/o.numTilesPerPage);o.pagesWithThumbErrors.has(t)||o.pagesWithThumbErrors.add(t)},this.recordTileLoaded=function(e,t,i){if(i){if(o.thumbsLoaded.has(e))return;o.thumbsLoaded.add(e)}else{if(o.iconsLoaded.has(e))return;o.iconsLoaded.add(e)}var n=!1;n=o.numTiles%o.numTilesPerPage==0?e>=o.numTiles-o.numTilesPerPage:e>=o.numTiles-o.numTiles%o.numTilesPerPage;var r=o.numTilesPerPage;if(n){var l=o.numTiles%o.numTilesPerPage;0!==l&&(r=l)}var a=Math.floor(e/o.numTilesPerPage);if(i||!t){var s=o.numTilesFinalizedByPage[a]||0;o.numTilesFinalizedByPage[a]=s+1}0===a&&o.handleTTI&&(!(o.iconsLoaded.has(e)&&o.thumbsLoaded.has(e))&&(o.numTilesLoadedOnFirstPage++,o.numTilesLoadedOnFirstPage===r&&o.handleTTI()));i&&(o.pagesWithThumbs.has(a)||o.pagesWithThumbs.add(a),o.anyThumbLoadedTimeByPage.get(a)||o.anyThumbLoadedTimeByPage.set(a,o.getTimeNow()),o.numTilesFinalizedByPage[a]===r&&o.allThumbsLoadedTimeByPage.set(a,o.getTimeNow()))},this.pruneTrackedPages=function(){o.startTimeByPage.forEach((function(e,t){!o.pagesToLog.has(t)&&!o.pagesCompletedLogging.has(t)&&o.getTimeNow()-e>2e3&&o.startTimeByPage.delete(t)}))},this.logCompletedPages=function(){o.pagesToLog.forEach((function(e){var t=o.startTimeByPage.get(e),i=Math.max(o.allThumbsLoadedTimeByPage.get(e),t),n=Math.max(o.anyThumbLoadedTimeByPage.get(e),t);!i||o.pagesWithThumbs.has(e)?o.pagesWithThumbErrors.has(e)?o.handlePageCompletedLogging(e):t&&i&&n&&(o.logPerfStats(e,t,n,i),o.handlePageCompletedLogging(e)):o.handlePageCompletedLogging(e)}))},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=[],this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=new Set,this.thumbsLoaded=new Set,this.startTimeByPage=new Map,this.allThumbsLoadedTimeByPage=new Map,this.anyThumbLoadedTimeByPage=new Map,this.pagesWithThumbErrors=new Set,this.pagesWithThumbs=new Set,this.pagesCompletedLogging=new Set,this.pagesToLog=new Set,this.handleTTI=n}return e.prototype.getTimeNow=function(){var e=n.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging.add(e),this.pagesToLog.delete(e),this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){i.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){i.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,n,o){i.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:n-t}),i.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:o-t})},e})();t.InfiniteTileGridLogger=o})),define("modules/clean/react/files_view/keyboard_focus",["require","exports","tslib","react"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WithKeyboardFocus=void 0;var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastMouseDown=0,t.onFocus=function(e){Date.now()-t.lastMouseDown>500&&t.props.onKeyboardFocus(e)},t.onMouseDown=function(){t.lastMouseDown=Date.now()},t}return i.__extends(t,e),t.prototype.render=function(){return this.props.children({onFocus:this.onFocus,onMouseDown:this.onMouseDown})},t})((n=i.__importDefault(n)).default.PureComponent);t.WithKeyboardFocus=o})),define("modules/clean/undo",["require","exports","tslib","purify","react","modules/constants/undo_strings","modules/core/notify"],(function(e,t,i,n,o,r,l){"use strict";var a,s;function d(){s&&(s(a),s=void 0,a=null)}Object.defineProperty(t,"__esModule",{value:!0}),t.notifyWithUndo=t.setHandleUndo=t.performUndo=void 0,n=i.__importStar(n),o=i.__importStar(o),t.performUndo=d,t.setHandleUndo=function(e,t){s=e,a=t||null},t.notifyWithUndo=function(e,t,i,n,u){if(void 0===u&&(u=r.UNDO),t&&Object.keys(t).length){a=t,s=i,n=null==n?30:n;var p=function(e){e.preventDefault(),d(),l.Notify.clear()};l.Notify.customSuccess(o.createElement(c,{message:e,undoButtonText:u,onUndo:p}),e,n)}else l.Notify.success(e)};var c=function(e){return"string"==typeof e.message?o.createElement("span",{"aria-live":"polite"},e.message," ",o.createElement("button",{className:"button-as-link",onClick:e.onUndo},e.undoButtonText)):o.createElement(o.Fragment,null,o.createElement("span",{"aria-live":"polite",dangerouslySetInnerHTML:{__html:n.sanitize(e.message.toHTML())}})," ",o.createElement("button",{className:"button-as-link",onClick:e.onUndo},e.undoButtonText))}})),define("retrieval-components/view-mode-toggle",["require","exports","tslib","retrieval-components/view-mode-toggle/view_mode_toggle"],(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.__exportStar(n,t)})),define("retrieval-components/view-mode-toggle/view_mode_toggle",["require","exports","tslib","react","react-intl","dig-components/icons/src","dig-components/menu","dig-components/buttons","dig-components/icons"],(function(e,t,i,n,o,r,l,a,s){"use strict";var d;function c(e,i,n){var l=o.defineMessage({id:"izeluw",defaultMessage:"Grid"}),a=o.defineMessage({id:"BOj5uG",defaultMessage:"Large grid"}),s=o.defineMessage({id:"kn0aTF",defaultMessage:"List"}),d=o.defineMessage({id:"+ElFUY",defaultMessage:"Large list"}),c=!i&&!n,u=[{mode:t.ViewMode.GRID,icon:r.GridViewDenseLine,label:e.formatMessage(l)},{mode:t.ViewMode.TILE,icon:r.GridViewLine,label:e.formatMessage(a)}];return c&&u.push({mode:t.ViewMode.CONDENSED_LIST,icon:r.ListViewDenseLine,label:e.formatMessage(s)}),u.push({mode:t.ViewMode.LIST,icon:r.ListViewLine,label:i?e.formatMessage(s):e.formatMessage(d)}),u}Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModeMenu=t.ViewModeToggle=t.ViewMode=void 0,n=i.__importStar(n),(d=t.ViewMode||(t.ViewMode={})).GRID="grid",d.TILE="tile",d.CONDENSED_LIST="condensed_list",d.LIST="list",t.ViewModeToggle=function(e){var i=e.className,r=e.currentMode,d=e.disabled,u=e.onSelection,p=e.treatLargeListAsList,f=e.withoutCondensedListMode,m=o.defineMessage({id:"slo33I",defaultMessage:"Select view type"}),h=o.useIntl(),g=h.formatMessage(m),_=c(h,p,f),E=_.find((function(e){return e.mode===r}))||_.find((function(e){return e.mode===t.ViewMode.LIST}));return n.createElement(l.Menu.Wrapper,{onSelection:u},(function(e){var o=e.getTriggerProps,c=e.getContentProps;return n.createElement(n.Fragment,null,n.createElement(a.IconButton,Object.assign({className:i,variant:"transparent","aria-label":g,disabled:d,withDropdownIcon:!0},o()),n.createElement(s.UIIcon,{src:E.icon})),n.createElement(l.Menu.Content,Object.assign({},c(),{placement:"bottom-end"}),n.createElement(t.ViewModeMenu,{currentMode:r,treatLargeListAsList:p,withoutCondensedListMode:f})))}))},t.ViewModeMenu=function(e){var t=e.currentMode,i=e.treatLargeListAsList,r=e.withoutCondensedListMode,a=c(o.useIntl(),i,r);return n.createElement(l.Menu.Segment,null,a.map((function(e){return n.createElement(l.Menu.SelectItem,{key:e.mode,value:e.mode,selected:e.mode===t,"aria-checked":e.mode===t,withRightAccessory:n.createElement(s.UIIcon,{src:e.icon})},e.label)})))}}));
//# sourceMappingURL=pkg-selectable-list.min.js-vflKFE4ua.map