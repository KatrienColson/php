define(["require","exports","tslib","react","react-intl","spectrum/modal","modules/clean/ajax","modules/core/browser_detection","modules/core/i18n","modules/clean/ux_analytics_modal_tracking","modules/constants/page_load","modules/clean/react/css","modules/clean/react/growth/first_task/first_task","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_data","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_invite_content","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_list","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_sidebar","modules/clean/react/table","modules/clean/viewer"],(function(e,t,a,s,i,n,o,r,l,m,d,c,u,_,f,v,b,p,g,h,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstTaskInviteModal=t.FirstTaskInviteModalWithoutCss=void 0,s=a.__importDefault(s),o=a.__importStar(o),r=a.__importStar(r);var I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={memberActionsData:void 0},t.focusRef=s.default.createRef(),t}return a.__extends(t,e),t.prototype.loadMemberActionsData=function(e){var t=this.props,s=t.evhMaxDays,i=t.memberList,n=t.relaunchModal,r=t.updateMemberList,l={is_current:!0,limit:i.length,offset:0,sort_column:"user_type",sort_direction:h.TableSortDir.ASC};o.WebRequest({url:"/team/admin/members/list_v2",data:l,subject_user:M.Viewer.get_viewer().work_user,success:function(t){var o={},l=new Date((new Date).setDate(s||0)).toLocaleDateString();JSON.parse(t).members.forEach((function(e){var t=e.user_id;o[t]=a.__assign(a.__assign({},v.getMemberInviteActionsProperties(e,l)),{onClose:function(){n(i)},deleteCallback:function(){for(var e=0;e<i.length&&i[e].user_id!==t;e++);i.splice(e,1),n(i)},roleUpdateCallback:function(e){for(var s=0;s<i.length;s++)if(i[s].user_id===t){var n=a.__assign({},i[s]);n.admin_role=e,i[s]=n}r(i)}})}),{}),e(o)}})},t.prototype.componentDidMount=function(){var e=this,t={platform:this.props.loggingExtras.is_client?f.Platform.DESKTOP_SSCV:r.is_supported_mobile_browser()?f.Platform.MOBILE_WEB:f.Platform.WEB};f.SMBFunnelLogger.setCommonTags(t),f.SMBFunnelLogger.log(_.AMPMetrics.ACTIVATION_IMM_VIEW),this.loadMemberActionsData((function(t){e.setState({memberActionsData:t})}))},t.prototype.componentDidUpdate=function(e){var t=this;e.memberList.length!==this.props.memberList.length&&this.loadMemberActionsData((function(e){t.setState({memberActionsData:e})}))},t.prototype.render=function(){var e=this.props,t=e.open,a=e.tieredAdmin,o=e.memberList,r=e.showSidebar,c=e.emails,_=e.sentEmails,f=e.handleOnClose,v=e.onCSVImport,h=e.handleOnSubmit,I=e.handleCSVImport,C=e.renderInputForm,w=e.renderSubmitBtn,S=e.loggingExtras,E=e.showImportCSV,k=e.isInviteLinkEnabled,A=e.growthActSmbMWInvitesActive,L=A?"invite-modal-first-task-mobile":"invite-modal-first-task",D=M.Viewer.get_viewer(),y=D.work_user,T=D.team_id,O=D.team_name;if(!y||!T||!O)return null;var V=y.id,W=1===o.length||A?l.intl.formatMessage({id:"5dI3gl",defaultMessage:"Invite team members"}):l.intl.formatMessage({id:"WzCl9b",defaultMessage:"Manage team members"});return s.default.createElement(i.IntlProvider,{defaultLocale:"en-US",locale:l.localeToBcp47LangTag(d.USER_LOCALE)},s.default.createElement(n.Modal,{className:A?"mw-invites-modal-sheet":"",open:t,ariaLabel:l.intl.formatMessage({id:"Ntdwnu",defaultMessage:"Invite Members"}),displayCloseButton:!0,onRequestClose:function(){_.length&&u.showClinkTooltip(u.TooltipType.Members),f()},overlayClickClose:!0,width:r?960:699,overflowY:!0,focusedElementOnOpen:this.focusRef,appElement:document.body,bodyClassName:"invite-modal "+L+" "+(r?L+"--sidebar-visible":"")},s.default.createElement(m.UXAnalyticsModalTracking,{id:"invite-modal"}),s.default.createElement("div",{className:L+"__container"},s.default.createElement("div",{className:L+"__content"},s.default.createElement("div",{className:L+"__title"},W),s.default.createElement(b.InviteModalInviteContent,{baseClass:L,focusRef:this.focusRef,currentUser:y,handleOnSubmit:h,onCSVImport:v,handleCSVImport:I,renderInputForm:C,renderSubmitBtn:w,showImportCSV:E,isInviteLinkEnabled:k,growthActSmbMWInvitesActive:A}),s.default.createElement(p.InviteModalMemberList,{baseClass:L,currentUserId:V,teamId:T,teamName:O,tieredAdmin:a,memberList:o,memberActionsData:this.state.memberActionsData,handleOnClose:f,loggingExtras:S,growthActSmbMWInvitesActive:A})),r&&s.default.createElement(g.InviteModalSidebar,{baseClass:L,memberList:o,emails:c,sentEmails:_}))))},t})(s.default.Component);t.FirstTaskInviteModalWithoutCss=I,t.FirstTaskInviteModal=c.requireCssWithComponent(I,["/static/css/dig-components/index.web-vfl48ffQ_.css","/static/css/teams/admin/widgets/invite_modal/invite_modal_first_task-vfludx3RI.css"])}));
//# sourceMappingURL=invite_modal_first_task.min.js-vflu3hVtI.map